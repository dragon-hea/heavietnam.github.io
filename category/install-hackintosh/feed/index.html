<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>install hackintosh Archives - Heavietnam</title>
	<atom:link href="https://heavietnam.ga/category/install-hackintosh/feed/" rel="self" type="application/rss+xml" />
	<link>https://heavietnam.ga</link>
	<description>Everythingforhackintosher</description>
	<lastBuildDate>Sat, 23 Apr 2022 10:22:57 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.9.3</generator>

<image>
	<url>https://heavietnam.ga/wp-content/uploads/2021/12/cropped-logo02-2-32x32.png</url>
	<title>install hackintosh Archives - Heavietnam</title>
	<link>https://heavietnam.ga</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>1 số lỗi ProperTree</title>
		<link>https://heavietnam.ga/2022/04/10/1-so-loi-propertree/</link>
					<comments>https://heavietnam.ga/2022/04/10/1-so-loi-propertree/#respond</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sun, 10 Apr 2022 14:47:35 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2953</guid>

					<description><![CDATA[<p>Monterey: Nếu các bạn đã lên Monterey thì có thể gặp những lỗi sau khi sử dụng ProperTree: Black screen ProperTree: Nguyên nhân là do gói tk đi kèm theo python bạn cài chưa tương thích với macOS Monterey Cách khác phục là các bạn tải gói python 3.9.7 (không phải bản universal) từ trang python.org hoặc tải [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/1-so-loi-propertree/">1 số lỗi ProperTree</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h1>Monterey:</h1>



<p>Nếu các bạn đã lên Monterey thì có thể gặp những lỗi sau khi sử dụng ProperTree:</p>



<ol><li>Black screen ProperTree:<ul><li>Nguyên nhân là do gói tk đi kèm theo python bạn cài chưa tương thích với macOS Monterey</li><li>Cách khác phục là các bạn tải gói python 3.9.7 (không phải bản universal) từ trang <a href="http://python.org/">python.org</a> hoặc tải trực tiếp <a href="https://www.python.org/ftp/python/3.9.7/python-3.9.7-macosx10.9.pkg">tại đây</a>. Sau đó tiến hành cài và tải bản ProperTree mới nhất <a href="https://github.com/corpnewt/ProperTree">tại đây</a>. Và chạy tập lệnh <code>buildapp-select.command</code> sau đó trong folder <code>Scripts</code> của ProperTree (chọn mục build app với python3)</li></ul></li><li>Không thể save và mở file plist:<ul><li>Nguyên nhân cũng tương tự như lỗi 1 đây là do sử dụng gói universal. </li><li>Cách khắc phục là các bạn tải bản ProperTree 3.9.7 (intel only) tại trang <a href="http://python.org/">python.org</a> hoặc tải <a href="https://www.python.org/ftp/python/3.9.7/python-3.9.7-macosx10.9.pkg">tại đây</a> sau đó chạy tập lệnh <code>buildapp-select.command</code> trong folder <code>Scripts</code> (nhớ chọn build app with python3).</li></ul></li></ol>



<h1>Ubuntu:</h1>



<ol><li>Khi run ProperTree gặp lỗi <strong><code>[ModuleNotFoundError: No module name 'tkinter']</code></strong><ul><li>Nguyên nhân là do tk chưa được cài đặt.</li><li>Cách khắc phục là chạy lệnh sau trong terminal <code>sudo apt-get install python3-tk -y</code></li></ul></li><li>ProperTree không chạy vì không đủ quyền:<ul><li>Nguyên nhân do ProperTree không có quyền để chạy</li><li>Cách khắc phục các bạn gõ lệnh sau vào terminal <code>chmod +x ProperTree.command</code></li></ul></li></ol>



<p>Và như vậy là xong nếu có lỗi gì mình sẽ tiếp tục cập nhật. Follow this forum để nhận được nhưng tin tức mới liên tục.</p>



<p>Source tham khảo: <a href="https://github.com/corpnewt/ProperTree">corpnewt/ProperTree: Cross platform GUI plist editor written in python. (github.com)</a></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/1-so-loi-propertree/">1 số lỗi ProperTree</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/10/1-so-loi-propertree/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>macOS 12: Monterey</title>
		<link>https://heavietnam.ga/2022/04/10/fix-loi-khong-mount-duoc-file-dmg-tren-monterey/</link>
					<comments>https://heavietnam.ga/2022/04/10/fix-loi-khong-mount-duoc-file-dmg-tren-monterey/#respond</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sun, 10 Apr 2022 14:38:27 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2945</guid>

					<description><![CDATA[<p>Tin tức mới trên Monterey SMBios: Các SMBios sau sẽ ko còn support nữa: iMac15,x và cũ hơn. Macmini6,x và cũ hơn. MacBook8,1 và cũ hơn. MacBookAir6,x và cũ hơn. MacBookPro11,3 và cũ hơn. Đối với những SMBios khác vẫn còn support. Hardware: các GPU sau sẽ không được support nữa Ivy Bridge (HD 4000 [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/fix-loi-khong-mount-duoc-file-dmg-tren-monterey/">macOS 12: Monterey</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h2>Tin tức mới trên Monterey</h2>



<h3>SMBios:</h3>



<p>Các SMBios sau sẽ ko còn support nữa:</p>



<ul><li>iMac15,x và cũ hơn.</li><li>Macmini6,x và cũ hơn.</li><li>MacBook8,1 và cũ hơn.</li><li>MacBookAir6,x và cũ hơn.</li><li>MacBookPro11,3 và cũ hơn.</li></ul>



<p>Đối với những SMBios khác vẫn còn support.</p>



<h3>Hardware:</h3>



<p>các GPU sau sẽ không được support nữa</p>



<ul><li>Ivy Bridge (HD 4000 and HD 2500 | bạn có thể dùng <a href="https://github.com/dortania/OpenCore-Legacy-Patcher/releases">OpenCore Legacy Patcher</a> để add support và có thể dùng <a href="https://github.com/chris1111/Patch-HD4000-Monterey">HD4000 Patcher</a> để add các kext và bundle của Big Sur)</li><li>Nvidia Kepler (GTX 6xx/7xx Cards | bạn có thể dùng OpenCore Legacy Patcher để add support và có thể dùng <a href="https://github.com/chris1111/Geforce-Kepler-patcher">Kepler Patcher</a> để add các kext và bundle của Big Sur)</li></ul>



<h3>AMD Patcher:</h3>



<p>Các bạn phải nhớ là Update Kernel Patcher nhé download <a href="https://github.com/AMD-OSX/AMD_Vanilla">ở đây</a>.</p>



<h3>Bluetooth:</h3>



<p>Ở thời điểm hiện tại bluetooth vẫn còn 1 số lỗi hãy đợi cộng đồng update kext riêng các dòng card ar9XXX đã chính thức không còn support.</p>



<h3>OTA Update:</h3>



<p>Nếu bạn đang sử dụng T2 SMBios thì phải boot với OpenCore 0.7.4+ và <code>SecureBootModel</code> set là <code>Default</code> nếu bạn không sử dụng T2 SMBios thì có thể set là <code>Default</code> hoặc <code>Disabled</code> xem chi tiết <a href="https://dortania.github.io/OpenCore-Post-Install/universal/security/applesecureboot.html#apecid">tại đây</a>.</p>



<h2>1 số app bị lỗi</h2>



<p>Tổng hợp 1 số app bị lỗi trên monterey</p>



<ol><li><strong>Illustrator 2021: </strong>(kể cả bản quyền và thuốc): Chuột phải thanh Menu bị hiện ở góc dưới chứ không xuất hiện ngay chỗ click. Update: AI dùng bản quyền thì cập nhật lên Illustrator 2022 fix lỗi này rồi.</li><li><strong>Mamp Pro</strong> bản thuốc ko chạy trên M1, Intel vẫn chạy.</li><li><strong>Cleanmymac:</strong> ae cứ than ko chạy, nhưng maclife có hướng dẫn fix từ hồi còn Beta rồi.</li><li><strong>Wirecast:</strong> Crash &#8211; Chưa có cách fix, chờ cập nhật thôi.</li><li><strong>Sketchup </strong>(thuốc): Crash.</li><li><strong>Tg Pro</strong> (bản thuốc): Crash: <strong>Update: </strong>Đã có bản 2.6.1 chạy được trên Monterey.</li><li><strong>Yoink</strong>: Không chạy.</li><li><strong>Adobe Audition:</strong> (bản thuốc) &#8211; Crash.</li><li><strong>On1 Photo Raw</strong> &#8211; Crash.</li><li><strong>Smart Album</strong> &#8211; Crash.</li><li><strong>TextSniper</strong> &#8211; Crash.</li><li><strong>Total Finder</strong> &#8211; Không ổn định.</li><li><strong>Airserver</strong>.</li><li><strong>Sketch</strong> &#8211; Lỗi trên Mac Intel, <strong>M1 xài bình thường</strong>.</li><li><strong>Photoscape x</strong>.</li><li><strong>Fl Studio</strong>.</li><li><strong>Itube Studio.</strong></li></ol>



<h2>Fix lỗi không Mount Disk được </h2>



<p>Hiện nay 1 số may xuất hiện tình trang không thể Mount được file dmg trên Monterey và đây là cách khắc mục:</p>



<p>B1: Mở terminal.</p>



<p>B2: Gõ dòng lệnh sau vào terminal.</p>



<p><code>hdiutil attach [ khoảng trắng ] path\to\dmg file&nbsp;</code></p>



<figure class="wp-block-image"><img src="https://imgur.com/xGfUsX3.png" alt=""/></figure>



<figure class="wp-block-image"><img src="https://imgur.com/yKYs3DM.png" alt=""/></figure>



<p>B3: Các bạn sẽ thấy file dmg được mount ngoài desktop ấn vào là dùng được.</p>



<figure class="wp-block-image"><img src="https://imgur.com/HTkzDvU.png" alt=""/></figure>



<p><strong>Lưu ý: Bài viết mang tính chất tạm thời tương lai có thể sẽ thay đổi thì mình sẽ cập nhật lại</strong></p>



<p>Source tham khảo: <a href="http://maclife.vn">maclife.vn</a></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/fix-loi-khong-mount-duoc-file-dmg-tren-monterey/">macOS 12: Monterey</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/10/fix-loi-khong-mount-duoc-file-dmg-tren-monterey/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Một số lỗi ở xuất hiện ở macOS Big Sur</title>
		<link>https://heavietnam.ga/2022/04/10/1-so-loi-o-xuat-hien-o-bigsur/</link>
					<comments>https://heavietnam.ga/2022/04/10/1-so-loi-o-xuat-hien-o-bigsur/#respond</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sun, 10 Apr 2022 14:26:37 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2940</guid>

					<description><![CDATA[<p>Stuck at&#160;Forcing CS_RUNTIME for entitlement Nhìn có vẻ giống như 1 lỗi nhưng nó không phải lỗi bạn cần khá nhiều thời gian để vượt qua nó. Không khởi động lại vì nó có thể phá hủy quá trình cài đặt của bạn. Stuck at&#160;PCI Configuration Begins&#160;ở các main X99 và X299 Ở Big Sur [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/1-so-loi-o-xuat-hien-o-bigsur/">Một số lỗi ở xuất hiện ở macOS Big Sur</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h2>Stuck at&nbsp;<code>Forcing CS_RUNTIME for entitlement</code></h2>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/cs-stuck.bddc4a2d.jpg" alt=""/></figure>



<p>Nhìn có vẻ giống như 1 lỗi nhưng nó không phải lỗi bạn cần khá nhiều thời gian để vượt qua nó. Không khởi động lại vì nó có thể phá hủy quá trình cài đặt của bạn.</p>



<h2>Stuck at&nbsp;<code>PCI Configuration Begins</code>&nbsp;ở các main X99 và X299</h2>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/rtc-error.d53fdc66.jpg" alt=""/></figure>



<p>Ở Big Sur các dòng main hedt bị thiếu các vùng rtc do đó macos gặp lỗi fix chi tiết theo trang&nbsp;<a href="../../../2022/01/22/fix-system-clocks-on-hedt/index.html">sau</a>.</p>



<h2>Stuck on&nbsp;<code>ramrod</code>(^^^^^^^^^^^^^)</h2>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/ramrod.55591fc5.jpg" alt=""/></figure>



<p>Khi bạn bị stuck ở dòng&nbsp;<code>ramrod</code>thì macOS sẽ bị reset sau đó lại gặp dòng này và tiếp tục reset. Nó đã tạo 1 vòng lập restart. Điều đó cho thấy bộ phận giả lập SMC của bạn đã bị hỏng vì vậy bạn có 2 sự lựa chọn:</p>



<ul><li>Sử dụng bản cập nhật mới nhất của VirtualSMC và Lilu sau đó add boot-arg&nbsp;&nbsp;<code>vsmcgen=1</code></li><li>Hoặc bạn có thể chuyển qua kext&nbsp;<a href="https://bitbucket.org/RehabMan/os-x-fakesmc-kozlek/downloads/">Fake-SMC</a>&nbsp;của rehabMan.</li><li>Lưu ý: không đồng thời sử dụng cả 2 kext VirtualSMC và Fake-SMC.</li></ul>



<h2>Kernel panic on&nbsp;<code>OPCIFamily</code>&nbsp;ở X79 and X99</h2>



<p>Lỗi này là do uncore PCI Bridges không được enable trong ACPI. Do đó IOPCIFamily sẽ bị kernel panic để giải quyết vấn đề này các bạn có thể dùng&nbsp;<a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/Source/SSDT-UNC.dsl">SSDT-UNC</a>&nbsp;chỉ cần biên dịch bằng Maciasl và sử dụng theo guide chi tiết&nbsp;<a href="../../../2021/09/29/xxviii-patch-dsdt-phan-3/index.html">tại đây</a>.</p>



<h2>DeviceProperties injection failing</h2>



<p>Khi gặp lỗi này các bạn sẽ không thể tiêm được device-properties được cách fix các có thể dùng SSDT-BRG0. Fix chi tiết theo trang&nbsp;<a href="../../../2021/09/29/xxiii-patch-card-doi-hoa-amd/index.html">sau</a>.</p>



<h2>Keyboard and Mouse broken</h2>



<p>Lỗi này khiến cho các HID-based devices như chuột và bạn phím bị hỏng trong khi các cổng USB vẫn hoạt động, để khắc phục tình trạng này các bạn add patch như sau:</p>



<p></p>



<pre class="wp-block-code"><code>// add vào config.plist -&gt; Kernel -&gt; Patch

base | string | _isSingleUser

Count | Integer | 1

Enabled | Boolean  |  True

Find  | Data | &lt;blank&gt;

Identifier | String | com.apple.iokit.IOHIDFamily

Limit | Integer |  0

Mask | Data | &lt;blank&gt;

MaxKernel | String | &lt;blank&gt;

MinKernel | String | 20.0.0

Replace | Data | B801000000C3

ReplaceMask | Data | &lt;blank&gt;

Skip | Integer | 0</code></pre>



<h2 id="early-kernel-panic-on-max-cpus-from-firmware-not-yet-initialized">Early Kernel Panic on&nbsp;<code>max_cpus_from_firmware not yet initialized</code></h2>



<p>Để fix lỗi này các bạn cần đảm bảo đang ở OpenCore version 0.6.0+ và&nbsp;<code>AvoidRuntimeDefrag</code>&nbsp;được enable.</p>



<p>Trên 1 số máy chủ yếu trên HP DC7900. Kernel không thể xác định chính xác có bao nhiêu luồng ở phần cứng của các bạn gây panic cách fix như sau.</p>



<pre class="wp-block-code"><code>// add vào config.plist -&gt; Kernel -&gt; Patch

base | string | _acpi_count_enabled_logical_processors

Count | Integer | 1

Enabled | Boolean  |  True

Find  | Data | &lt;blank&gt;

Identifier | String | Kernel

Limit | Integer |  0

Mask | Data | &lt;blank&gt;

MaxKernel | String | &lt;blank&gt;

MinKernel | String | 20.0.0

Replace | Data | B804000000C3

ReplaceMask | Data | &lt;blank&gt;

Skip | Integer | 0

// thay 04 bằng số luồng ở phần cứng của các bạn</code></pre>



<h2>Can not update to newer versions of Big Sur</h2>



<p>Có 2 trường hợp Broken Update Utility và Broken Seal.</p>



<h3>Broken Update Utility</h3>



<p>lỗi này thường xảy ra khi bạn dùng bản beta. Để khắc phục chúng ta chỉ cần hủy đăng kí và đăng kí lại</p>



<pre class="wp-block-code"><code># hủy đăng kí
sudo /System/Library/PrivateFrameworks/Seeding.framework/Resources/seedutil unenroll
# đăng kí lại
sudo /System/Library/PrivateFrameworks/Seeding.framework/Resources/seedutil enroll</code></pre>



<p>Tiếp theo bản vào cài đặt và kiểm tra lại nếu vẫn chưa được hãy kiểm tra tới phần tiếp theo.</p>



<h3>Broken Seal</h3>



<p>bạn gõ câu lệnh sau vào terminal</p>



<pre class="wp-block-code"><code>diskutil apfs list</code></pre>



<p>Nhìn vào phần&nbsp;<code>Snapshot Sealed</code>&nbsp;Nếu nó trả về là&nbsp;<code>broken</code>&nbsp;thì bạn hãy fix theo các cách sau:</p>



<ul><li>Update OpenCore version 0.6.4+</li><li>Khôi phục đến bản Snapshot cũ hơn tham khảo tại link&nbsp;<a href="https://dortania.github.io/OpenCore-Install-Guide/troubleshooting/extended/post-issues.html#rolling-back-apfs-snapshot">sau</a>.</li></ul>



<h2>Kernel Panic on&nbsp;<code>Rooting from the live fs</code></h2>



<p>Lỗi đầy đủ:</p>



<pre class="wp-block-code"><code>Rooting from the live fs of a sealed volume is not allowed on a RELEASE build
</code></pre>



<p>Do SecureBoot được khởi động để khắc phục chỉ cần update lên version 0.6.4+</p>



<h2>Asus Z97 and HEDT (cụ thể là X99 và X299) thất bại trong giai đoạn 2 của quá trình cài đặt.</h2>



<p>Có 2 cách fix:</p>



<ul><li>Cài Big Sur vào 1 máy khác sau đó chuyển ổ đĩa vào máy cần cài</li><li>Fix the motherboard&#8217;s NVRAM.<ul><li>Chủ yếu cho Asus Z97 series.</li></ul></li><li>Chi tiết tham khảo tại trang&nbsp;<a href="https://www.reddit.com/r/hackintosh/comments/jw7qf1/haswell_asus_z97_big_sur_update_and_installation/">sau</a>.</li></ul>



<h2>Laptops kernel panicking on&nbsp;<code>cannot perform kext scan</code></h2>



<p>Lỗi này thường xảy ra do có nhiều bản sao của cùng 1 kext trong bộ nhớ cache của kernel. Thường là kext voodooinput. Để khắc phục tình trạng này các bạn hãy kiểm tra trong config.plist -->&nbsp; kernel --> add và chỉ enable 1 kext voodooinput duy nhất.</p>



<h2>Reboot on &#8220;AppleUSBHostPort::createDevice: failed to create device&#8221; on macOS 11.3+</h2>



<p>Để fix lỗi này các bạn cần phải tắt&nbsp;<code>XhciPortLimit</code>&nbsp;ở mục&nbsp;<code>Kernel -&gt; Quirks</code>&nbsp; và map usb theo hướng dẫn&nbsp;<a href="../../../2021/09/29/vi-1map-usb-intel-and-amd/index.html">tại đây</a>.</p>



<h2>An error occurred preparing the software update.</h2>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/ESyQ5QL.jpg" alt=""/></figure>



<p>Có 3 cách fix cho trường hợp này:</p>



<ul><li>Bật firmwarevolume trong config.plist lên </li><li>Có thể là do ổ cứng của bạn: <ul><li>Thử boot bằng hdd</li><li>Hoặc thay ổ mới</li><li>Cần tránh mua các ổ sau<ul><li>Kingston, Kingspec, Kingmax, Colorful, Fgloway,&#8230;.</li></ul></li></ul></li><li>Hoặc bạn có thể tạo máy ảo rồi dùng Time Machine tạo thành file Backup sao đó tiến hành bung file ra trong Recovery của macOS trên USB. </li></ul>



<h2>Failed to install required firmware update</h2>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/y4vGxLo.jpg" alt=""/></figure>



<p>Để khắc phụ lỗi này các bạn sẽ cần enable <code>AdviseFeatures</code> trong <code>EFI --> OC --> config.plist</code></p>



<p>Source tham khảo: <a href="https://dortania.github.io/OpenCore-Install-Guide/extras/big-sur/#stuck-at-forcing-cs-runtime-for-entitlement">OpenCore and macOS 11: Big Sur | OpenCore Install Guide (dortania.github.io)</a></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/1-so-loi-o-xuat-hien-o-bigsur/">Một số lỗi ở xuất hiện ở macOS Big Sur</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/10/1-so-loi-o-xuat-hien-o-bigsur/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Fix RTC Manual</title>
		<link>https://heavietnam.ga/2022/04/10/fix-rtc-manual/</link>
					<comments>https://heavietnam.ga/2022/04/10/fix-rtc-manual/#comments</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sun, 10 Apr 2022 01:48:18 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2913</guid>

					<description><![CDATA[<p>Đối với lỗi thiếu RTC thì có 3 cách để sửa do macOS cần RTC mà ko cần AWAC do đó ta nên disable AWAC và Enable RTC. Static Patch B1: Dump DSDT theo hướng dẫn tại đây. B2: Mở DSDT ra và search ACPI000E ta sẽ thấy như sau: B3: search PNP0B00 ta sẽ [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/fix-rtc-manual/">Fix RTC Manual</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Đối với lỗi thiếu RTC thì có 3 cách để sửa do macOS cần RTC mà ko cần AWAC do đó ta nên disable AWAC và Enable RTC.</p>



<h2>Static Patch </h2>



<p>B1: Dump DSDT theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/xxvi-patch-dsdt-phan-1/">tại đây</a>.</p>



<p>B2: Mở DSDT ra và search <code>ACPI000E</code> ta sẽ thấy như sau:</p>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/UpcoVpV.png" alt=""/></figure>



<p>B3: search <code>PNP0B00</code> ta sẽ thấy như sau</p>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/xsvaKc3.png" alt=""/></figure>



<p>B4: Bạn chú ý phần khoanh đỏ ta sẽ có thể hiểu như sau:</p>



<ul><li>Method(_STA thể hiện status của device đó ở đây là device RTC và AWAC</li><li>Tiếp đó sẽ là câu lệnh if ta sẽ thấy ở AWAC là <code>If (LEqual (STAS, zero))</code> ở RTC là <code>If (LEqual (STAS, One)) </code></li><li>Vvà trả về 2 giá trị là 0x0f và 0x00<ul><li>0x0f: enable</li><li>0x00: disable</li></ul></li><li>Từ đó ta có thể thấy như sau khi STAS=zero tức là điều kiện của AWAC đúng sẽ trả về giá trị là <code>0x0f</code>. Ngược lại điều kiện ở RTC sai tức là trả về giá trị là <code>0x00</code></li><li>Ngược lại khi STAS=one tức là điều kiện của AWAC sai và trả về là <code>0x00</code>. Khi này điều kiện ở RTC đúng và trả về là <code>0x0f</code></li><li>Như vậy có thể hiểu rằng khi STAS=one thì enable RTC và disable AWAC và ngược lại</li><li>Nhưng STAS thì được các os set </li></ul>



<p>B5: Như vậy ta đã hiểu được nguyên lý hoạt động của method _STA. Vì vậy để fix nó ta có 3 cách đi ở phần này mình sẽ hướng dẫn cách đi đầu tiên là static patch. </p>



<ul><li>Ta nhận thấy rằng giá trị method _sta phụ thuộc vào if ((STAS vậy nếu như ta xóa if đi và chỉnh cho giá trị method _STA của rtc luôn hoạt động thì RTC được enable</li></ul>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/WfXnZuR.png" alt=""/></figure>



<ul><li>Sao khi xóa ta được:</li></ul>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/AoHhCha.png" alt=""/></figure>



<p>B6: Như vậy là xong vì macOS chỉ cần RTC không cần AWAC.</p>



<h2>Hotpatch</h2>



<h3>Sửa giá trị STAS cho nó luôn bằng one.</h3>



<p>B1: Ta cần xác định biến được dùng để so sánh trong method <code>_sta</code> </p>



<ul><li>Search <code>PNP0B00</code> nhìn vào method STA ta sẽ thấy biến được dùng để so sánh như ở trên là STAS có 1 số máy là STSl vân vân</li></ul>



<p>B2: Tạo SSDT-AWAC với nói dung như sau:</p>



<pre class="wp-block-code"><code>
DefinitionBlock ("", "SSDT", 2, "heavn", "AWAC", 0x00000000)
{
    External (STAS, IntObj)

    Scope (_SB)
    {
        Method (_INI, 0, NotSerialized)  // _INI: Initialize
        {
            If (_OSI ("Darwin"))
            {
                STAS = One
            }
        }
    }
}
</code></pre>



<p> B3: Thay <code>STAS</code> bằng biến mà method <code>_STA</code> dùng để so sánh. </p>



<p>B4: Save lại.</p>



<p>B5: Bỏ file vào EFI &#8211;> OC &#8211;> ACPI hoặc EFI &#8211;> clover &#8211;> ACPI &#8211;> patched (snaps nếu ở OpenCore).</p>



<h3>Sử dụng SSDT-RTC0</h3>



<p>B1: Tải SSDT-RTC0 <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/Source/SSDT-RTC0.dsl">tại đây</a>.</p>



<p>B2: Xác định đường dẫn: </p>



<ul><li>Search <code>PNP0B00</code> ta sẽ thấy được đường dẫn </li></ul>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/zz4tg5t.png" alt=""/></figure>



<ul><li>Ở đây ta có đường dẫn là _SB.PCI0.LPCB.RTC</li></ul>



<p>B3: Tiến hành chỉnh sửa vào SSDT-RTC0</p>



<pre class="wp-block-code"><code>//thay _SB_.PCI0.LPCB bằng đường dẫn mà bạn tìm thấy

DefinitionBlock ("", "SSDT", 2, "ACDT", "RTC0", 0x00000000)
{
    External (_SB_.PCI0.LPCB, DeviceObj)    // (from opcode)

    Scope (_SB.PCI0.LPCB)
    {
        Device (RTC0)
        {
            Name (_HID, EisaId ("PNP0B00"))  // _HID: Hardware ID
            Name (_CRS, ResourceTemplate ()  // _CRS: Current Resource Settings
            {
                IO (Decode16,
                    0x0070,             // Range Minimum
                    0x0070,             // Range Maximum
                    0x01,               // Alignment
                    0x08,               // Length
                    )
                IRQNoFlags ()
                    {8}
            })
            Method (_STA, 0, NotSerialized)  // _STA: Status
            {
                If (_OSI ("Darwin")) {
                    Return (0x0F)
                } Else {
                    Return (0);
                }
            }
        }
    }
}</code></pre>



<p>B4: Bỏ nó vào EFI &#8211;> OC &#8211;> ACPI hoặc EFI &#8211;> Clover &#8211;> ACPI &#8211;> Patched (snaps nếu là OC)</p>



<p><strong>Source tham khảo: <a href="https://www.facebook.com/groups/2631037280276507/user/100007125750144">(7) Văn Hùng Nguyễn | Facebook</a> | <a href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/awac-methods/manual.html#finding-the-acpi-path">Fixing System Clocks: Manual | Getting Started With ACPI (dortania.github.io)</a> | <a href="http://howtohackintosh.top">Howtohackintosh.top</a></strong></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/10/fix-rtc-manual/">Fix RTC Manual</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/10/fix-rtc-manual/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Emulated NVRAM</title>
		<link>https://heavietnam.ga/2022/04/09/emulated-nvram/</link>
					<comments>https://heavietnam.ga/2022/04/09/emulated-nvram/#comments</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sat, 09 Apr 2022 15:37:03 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2910</guid>

					<description><![CDATA[<p>Hầu hết các model đều native nhận NVRAM nhưng đối với các chip set X99 và X299 series thì bạn cần phải patch NVRAM. Đối với B360, B365, H310, H370, Z390 thì bạn có thể sử dụng SSDT-PMC để kích hoạt được NVRAM. Gen 10 thì không cần SSDT này. Cleaning out the Clover gunk [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/emulated-nvram/">Emulated NVRAM</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Hầu hết các model đều native nhận NVRAM nhưng đối với các chip set X99 và X299 series thì bạn cần phải patch NVRAM.</p>



<p>Đối với B360, B365, H310, H370, Z390 thì bạn có thể sử dụng <a href="https://heavietnam.ga/2022/03/10/ssdt-recomend/">SSDT-PMC</a> để kích hoạt được NVRAM. Gen 10 thì không cần SSDT này.</p>



<h2>Cleaning out the Clover gunk</h2>



<p>Có thể bạn không biết nhưng Clover có thêm các tệp RC vào macOC để mô phỏng nvram điều này sẽ xung đột với phương pháp mô phỏng của OpenCore. Để khác phục các bạn sẽ xóa các file sau:</p>



<ul><li><code>/Volumes/EFI/EFI/CLOVER/drivers64UEFI/EmuVariableUefi-64.efi</code></li><li><code>/Volumes/EFI/nvram.plist</code></li><li><code>/etc/rc.clover.lib</code></li><li><code>/etc/rc.boot.d/10.save_and_rotate_boot_log.local</code></li><li><code>/etc/rc.boot.d/20.mount_ESP.local</code></li><li><code>/etc/rc.boot.d/70.disable_sleep_proxy_client.local.disabled</code></li><li><code>/etc/rc.shutdown.d/80.save_nvram_plist.local​</code></li></ul>



<ul><li><code>/etc/rc.boot.d</code></li><li><code>/etc/rc.shutdown.d​</code></li></ul>



<p>Nếu các thư mục trống các bạn vẫn phải xóa chúng.</p>



<h2>Kiểm tra xem NVRAM của bạn có hoạt động hay không</h2>



<pre class="wp-block-code"><code>// dán từng dòng code sau vào

sudo -s
nvram -c
nvram myvar=test
exit

// reboot và chạy tiếp dòng sau

nvram -p | grep -i myvar

// nếu không có gì trả về thì nvram bạn không hoạt động. Nếu như nó trả về 1 dòng có từ khóa myvar test thì nvram của bạn hoạt động

// lệnh nvram -c yêu cầu tắt sip. Tuy nhiên bạn có thể thay thế dòng này bằng cách reset nvram ở menu boot (bật Misc -&gt; Security -&gt; AllowNvramReset -&gt; YES)</code></pre>



<h2>Enabling emulated NVRAM</h2>



<p>B1:Chỉnh config theo sau:</p>



<ul><li>Booter:<ul><li>DisableVariableWrite: NO</li></ul></li><li>Misc -> Security:<ul><li>ExposeSensitiveData: 0x3</li></ul></li><li>NVRAM:<ul><li>LegacyEnable: YES</li><li>LegacyOverwrite: YES</li><li>LegacySchema: được OpenCore set mặc định</li><li>WriteFlash: YES</li></ul></li></ul>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/OpenCore-Post-Install/assets/img/nvram.c97ef040.png" alt=""/></figure>



<p>Bây giờ bạn sẽ chạy <a href="https://github.com/acidanthera/OpenCorePkg/releases">LogoutHook.command</a> (trong /Utilities/LogoutHook/). </p>



<pre class="wp-block-code"><code>// chạy đoạn code sau 
sudo defaults write com.apple.loginwindow LogoutHook</code></pre>



<p>B2: Bạn sẽ kéo file LogoutHook.command vào terminal và nhấn enter</p>



<p>Lưu ý: Boot-arg <code>-x</code> yêu cầu NVRAM để hoạt động. với những macOS 10.12- thì điều này sẽ không khả dụng. Bạn sẽ cần copy file <code>nvram.mojave</code> vào cùng folder với <code>LogoutHook.command</code>. Nó sẽ gọi nvram.mojave thay vì gọi NVRAM hệ thống.</p>



<p><strong>Source: <a href="https://dortania.github.io/OpenCore-Post-Install/misc/nvram.html#enabling-emulated-nvram-with-a-nvram-plist">Emulated NVRAM | OpenCore Post-Install (dortania.github.io)</a></strong></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/emulated-nvram/">Emulated NVRAM</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/09/emulated-nvram/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Kernel issue</title>
		<link>https://heavietnam.ga/2022/04/09/kernel-issue/</link>
					<comments>https://heavietnam.ga/2022/04/09/kernel-issue/#respond</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sat, 09 Apr 2022 10:24:19 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2904</guid>

					<description><![CDATA[<p>Stuck on [EB&#124;#LOG:EXITBS:START] Xem chi tiết tại đây. Stuck on EndRandomSeed Fix giống như lỗi Stuck on [EB&#124;#LOG:EXITBS:START] Đối với các máy đang sử dụng OpenCore version 0.7.3+ boot Catalina bị stuck lỗi này thì chuyển SecureBootModel trong config về Disable. Stuck sau khi select macOS partion ở OpenCore Fix giống như lỗi Stuck on [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/kernel-issue/">Kernel issue</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h2>Stuck on [EB|#LOG:EXITBS:START]</h2>



<p>Xem chi tiết <a href="https://heavietnam.ga/2022/03/03/eblogexitbsstart/">tại đây</a>.</p>



<h2>Stuck on <code>EndRandomSeed</code></h2>



<ul><li>Fix giống như lỗi Stuck on [EB|#LOG:EXITBS:START]</li><li>Đối với các máy đang sử dụng OpenCore version 0.7.3+ boot Catalina bị stuck lỗi này thì chuyển <code>SecureBootModel</code> trong config về <code>Disable</code>. </li></ul>



<h2>Stuck sau khi select macOS partion ở OpenCore</h2>



<ul><li>Fix giống như lỗi Stuck on [EB|#LOG:EXITBS:START]</li><li>Nên sử dụng <a href="https://heavietnam.ga/2022/04/09/opencore-debug/">EFI debug</a> trong trường hợp này.</li></ul>



<h2>Kernel Panic on <code>Invalid frame pointer</code></h2>



<p>Đây là lỗi ở <code>Booter --&gt; quirks</code> các bạn sẽ tiến hành check các phần sau:</p>



<ul><li>DevirtualiseMmio<ul><li>Một số Certain MMIO vẫn yêu được bật để có thể hoạt động được vì vậy bạn cần loại trừ các Certain này trong <code>Booter -&gt; MmioWhitelist</code> hoặc disable hoàn toàn tính năng này</li><li>Xem chi tiết <a href="https://heavietnam.ga/2022/01/31/using-devirtualisemmio/">tại đây</a></li></ul></li><li>SetupVirtualMap <ul><li>Tính năng này là bắt buộc đối với hầu hết các model. Nếu chưa có bạn hãy bật lên</li><li>Tuy nhiên 1 số model sẽ không hoạt động với quirks này và có thể xảy ra panic<ul><li>Intel&#8217;s Ice Lake series</li><li>Intel&#8217;s Comet Lake series</li><li>AMD&#8217;s B550</li><li>AMD&#8217;s A520</li><li>AMD&#8217;s TRx40</li><li>VMs like QEMU</li></ul></li></ul></li></ul>



<p>1 số lỗi khác có thể xảy ra do macos xung đột với tính năng write protection from CR0 register để giải quyết ta có thể làm như sau:</p>



<ul><li>Nếu firmware của bạn support MATs (2018+) thì làm theo sau:<ul><li>EnableWriteUnprotector -&gt; False</li><li>RebuildAppleMemoryMap -&gt; True</li><li>SyncRuntimePermissions -&gt; True</li></ul></li><li>Đối với những firmware cũ hơn thì bạn chỉnh theo sau:<ul><li>EnableWriteUnprotector -&gt; True</li><li>RebuildAppleMemoryMap -&gt; False</li><li>SyncRuntimePermissions -&gt; False</li></ul></li></ul>



<p>Tuy nhiên đối với 1 số máy thì gen 6 đã hộ trợ MATs để check xem máy bạn có hỗ trợ không bạn có thể check ở OpenCore log. </p>



<pre class="wp-block-code"><code>OCABC: MAT support is 1

// Nếu hiện là 1 tức là support còn hiện là 0 tức là không support</code></pre>



<h2 id="stuck-on-eb-ld-ofs-err-0xe-when-booting-preboot-volume">Stuck on&nbsp;<code>[EB|LD:OFS] Err(0xE)</code>&nbsp;when booting preboot volume</h2>



<pre class="wp-block-code"><code>// full error

&#91;EB|`LD:OFS] Err(0xE) @ OPEN (System\\Library\\PrelinkedKernels\\prelinkedkernel)</code></pre>



<p>Lỗi này xảy ra khi bạn preboot volume không được cập nhất đúng cách sẽ fix theo sau:</p>



<ul><li>Enable <code>JumpstartHotplug</code> ở <code>UEFI -&gt; APFS</code> (Nếu không có nó sẽ không thể boot vào recovery ở macos)</li><li>Boot vào recovery</li><li>mở terminal và chạy đoạn code sau:</li></ul>



<pre class="wp-block-code"><code>// Đầu tiên cần tìm preboot volume
diskutil list

// Nhìn vào list sau, ở đây preboot volume là disk5s2
/dev/disk5 (synthesized):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      APFS Container Scheme -                      +255.7 GB   disk5
                                 Physical Store disk4s2
   1:                APFS Volume ⁨Big Sur HD - Data⁩       122.5 GB   disk5s1
   2:                <strong>APFS Volume ⁨Preboot⁩</strong>                 309.4 MB   disk5s2
   3:                APFS Volume ⁨Recovery⁩                887.8 MB   disk5s3
   4:                APFS Volume ⁨VM⁩                      1.1 MB     disk5s4
   5:                APFS Volume ⁨Big Sur HD⁩              16.2 GB    disk5s5
   6:              APFS Snapshot ⁨com.apple.os.update-...⁩ 16.2 GB    disk5s5s

// Mount Preboot volume
diskutil mount disk5s2

// sau đó run updatePreboot trên the Preboot volume
diskutil apfs updatePreboot /volume/disk5s2

// reboot hệ thống
reboot</code></pre>



<h2>Stuck on <code>OCB: LoadImage failed - Security Violation</code></h2>



<pre class="wp-block-code"><code>// full error

OCSB: No suitable signature - Security Violation
OCB: Apple Secure Boot prohibits this boot entry, enforcing!
OCB: LoadImage failed - Security Violation</code></pre>



<p>Điều này là do Apple Secure Boot đã bị lỗi thời hoặc thiếu trên preboot của bạn volume dẫn đến failure to load nếu bạn có bật securebootmodel. Lý do cho các file này bị thiếu là 1 lỗi của macOS.</p>



<p>Để khắc phục lỗi này các bạn làm theo sau:</p>



<ul><li>Disable SecureBootModel <ul><li>&nbsp;<code>Misc -&gt; Security -&gt; SecureBootModel -&gt; Disabled</code></li></ul></li><li>cài đặt lại bản macos mới nhất</li><li>hoặc copy the Secure Boot manifests từ&nbsp;<code>/usr/standalone/i386</code>&nbsp;to&nbsp;<code>/Volumes/Preboot/&lt;UUID&gt;/System/Library/CoreServices</code><ul><li>Bạn có thể chỉnh điều này qua termianl ở recovery vì preboot volume không thể chỉnh sửa qua finder</li><li>Chạy đoạn code sau ở terminal <br> </li></ul></li></ul>



<pre class="wp-block-code"><code>// Tìm preboot volume
diskutil list

// Nhìn vào đoạn sau ta thấy preboot volume là disk5s2
/dev/disk5 (synthesized):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      APFS Container Scheme -                      +255.7 GB   disk5
                                 Physical Store disk4s2
   1:                APFS Volume ⁨Big Sur HD - Data⁩       122.5 GB   disk5s1
   2:                <strong>APFS Volume ⁨Preboot⁩  </strong>               309.4 MB   disk5s2
   3:                APFS Volume ⁨Recovery⁩                887.8 MB   disk5s3
   4:                APFS Volume ⁨VM⁩                      1.1 MB     disk5s4
   5:                APFS Volume ⁨Big Sur HD⁩              16.2 GB    disk5s5
   6:              APFS Snapshot ⁨com.apple.os.update-...⁩ 16.2 GB    disk5s5s

// mount Preboot volume
diskutil mount disk5s2

// CD vào Preboot volume
// Lưu ý rằng preboot volume có đường dẫn là /System/Volumes/Preboot
cd /System/Volumes/Preboot

// lấy UUID
ls
 46923F6E-968E-46E9-AC6D-9E6141DF52FD
 CD844C38-1A25-48D5-9388-5D62AA46CFB8

// nếu có nhiều UUID cũng hiện (bạn dual nhiều macos), bạn sẽ cần xác định UUID nào là chính xác
// Để làm như vậy bạn sẽ tiến hành in ra .disk_label.contentDetails của mỗi volume

cat ./46923F6E-968E-46E9-AC6D-9E6141DF52FD/System/Library/CoreServices/.disk_label.contentDetails
 Big Sur HD%

cat ./CD844C38-1A25-48D5-9388-5D62AA46CFB8/System/Library/CoreServices/.disk_label.contentDetails
 Catalina HD%


// thay CD844C38-1A25-48D5-9388-5D62AA46CFB8 với UUID của bạn
cd ~
sudo cp -a /usr/standalone/i386/. /System/Volumes/Preboot/CD844C38-1A25-48D5-9388-5D62AA46CFB8/System/Library/CoreServices</code></pre>



<h2>Stuck on <code>OCABC: Memory pool allocation failure - Not Found</code></h2>



<p>Để khắc phục các bạn có thể chỉnh setting BIOS theo sau:</p>



<ul><li>Above4GDecoding: Enabled</li><li>CSM: Disabled<ul><li>1 vài laptop phải bật CSM</li></ul></li><li>update bios </li></ul>



<h2>Stuck on <code>Buffer Too Small</code></h2>



<ul><li>Enable Above4GDecoding in the BIOS</li></ul>



<h2>Stuck on <code>Plist only kext has CFBundleExecutable key</code></h2>



<p>Đường dẫn không chính xác trong config.plist. Để khắc phục tiến hành snapshot bằng propertree xem cách snapshot <a href="https://heavietnam.ga/2021/09/29/tim-hieu-ve-hackintosh/">tại đây</a></p>



<h2>Stuck on <code>This version of Mac OS X is not supported: Reason Mac…</code></h2>



<p>Lỗi này xảy ra khi SMBios không còn được hỗ trợ nữa để khắc phục lỗi này các bạn có 2 phương pháp:</p>



<ul><li>Add boot-arg <code>-no_compat_check</code></li><li>Hoặc thay các SMBios được hỗ trợ:<ul><li>Catalina:<ul><li>iMac13,x+</li><li>iMacPro1,1</li><li>MacPro6,1+</li><li>Macmini6,x+</li><li>MacBook8,1+</li><li>MacBookAir5,x+</li><li>MacBookPro9,x+</li></ul></li><li>Big Sur:<ul><li>iMac14,4+</li><li>iMacPro1,1</li><li>MacPro6,1+</li><li>Macmini7,1+</li><li>MacBook8,1+</li><li>MacBookAir6,x+</li><li>MacBookPro11,x+</li></ul></li><li>Monterey<ul><li>iMac16,1+</li><li>iMacPro1,1</li><li>MacPro6,1+</li><li>Macmini7,1+</li><li>MacBook9,1+</li><li>MacBookAir7,1+</li><li>MacBookPro11,3+</li></ul></li></ul></li></ul>



<h2><code>Couldn't allocate runtime area errors</code></h2>



<p>Xem cách fix KASLR <a href="https://heavietnam.ga/2022/01/31/using-devirtualisemmio/">tại đây</a></p>



<h2>Stuck on <code>RTC…, PCI Configuration Begins, Previous Shutdown…, HPET, HID: Legacy…</code></h2>



<p>Đây là nơi  có  nhiều PCI device được thiết lập và cấu hình và là nơi  các lỗi khởi động sẽ xảy ra:</p>



<ul><li><code>apfs_module_start...</code>,</li><li><code>Waiting for Root device</code>,</li><li><code>Waiting on...IOResources...</code>,</li><li><code>previous shutdown cause...</code></li></ul>



<p>Những vấn đề chính gây lỗi:</p>



<ul><li>Thiếu EC (cata+): <ul><li>Thêm SSDT-EC theo <a href="https://heavietnam.ga/2022/03/10/ssdt-recomend/">link</a></li><li>Bỏ SSDT-EC vào EFI --> OC --> ACPI và snaps (hoặc EFI --> Clover --> ACPI --> Patched)</li></ul></li><li>Xung đột IRQ: <ul><li>dump SSDT-HPET theo <a href="https://heavietnam.ga/2021/09/29/ii-patch-am-thanh-voi-apple-alc-with-patch-hpet/#Patch_Hpet_IRQ">link</a> </li></ul></li><li>PCI allocation issue:<ul><li>Update BIOS.</li><li>Bật Above4G trong bios. Nếu bios của bạn không có option này hãy add boot-arg <code>npci=0x2000</code> <ul><li>Các main X99 and X299 có thể yêu cầu cả ncpi boot-arg và Above4G trong bios</li><li>AMD CPU không đồng thời bật cả Above4G và NCPI trong boot-arg vì chúg sẽ xung đột</li><li>Đối với bios thế hệ 2020+ thì khi bật Above4G các bạn phải set Booter -&gt; Quirks -&gt; ResizeAppleGpuBars:0 vì Resizable BAR Support có thể sẽ trở nên khả dụng </li></ul></li><li>CSM disabled, Windows 8.1/10 UEFI Mode enabled.</li></ul></li><li>NVMe or SATA issue:<ul><li>không sử dụng Samsung PM981 or Micron 2200S NVMe SSD</li><li>cài đặt latest firmware cho Samsung 970 EVO Plus xem chi tiết <a href="https://semiconductor.samsung.com/consumer-storage/support/tools/">tại đây</a></li><li>Disable SATA Hot-Plug trong bios</li><li>Đảm bảo ổ NVMe được đặt là NVMe trong bios</li></ul></li><li>NVRAM Failing:<ul><li>Đây là lỗi phổ biến trên các dòng HEDT hoặc trên các main 300 series<ul><li>Trên 300 series: tải và cài đặt SDT-PMC <a href="https://heavietnam.ga/2022/03/10/ssdt-recomend/">tại đây</a></li><li>HEDT thì các bạn sẽ Emulating NVRAM theo link <a href="https://heavietnam.ga/2022/04/09/emulated-nvram/">sau</a> (chỉ cần chỉnh config không cần chạy lệnh)</li></ul></li></ul></li></ul>



<ul><li>RTC missing<ul><li>Với các chip 300+ series bạn cần <a href="https://heavietnam.ga/2022/03/10/ssdt-recomend/">SSDT-AWAC</a></li><li>Đối với các máy hedt (X99 và X299) các RTC device sẽ bị thiếu  cần dùng SSDT-RTC0-RANGE xem chi tiết <a href="https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/">tại đây</a></li><li>1 số máy HP cũng gặp trường hợp này các bạn có thể dùng SSDT-RTC xem chi tiết các fix <a href="https://heavietnam.ga/2022/04/10/fix-rtc-manual/">tại đây</a></li></ul></li></ul>



<h2>Stuck at <code>ACPI table loading on B550</code></h2>



<p>Thêm SSDT-CPUR.aml <a href="https://github.com/dortania/Getting-Started-With-ACPI/blob/master/extra-files/compiled/SSDT-CPUR.aml">tại đây</a>.</p>



<h2 id="waiting-for-root-device-or-prohibited-sign-error">&#8220;<code>Waiting for Root Device</code>&#8221; or &#8220;<code>Prohibited Sign error</code>&#8220;</h2>



<ul><li>USB<ul><li>Map USB theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/vi-1map-usb-intel-and-amd/">tại đây</a></li><li><code>Kernel -&gt; Quirks -&gt; XhciPortLimit -&gt; flase</code></li><li>1 vài lỗi khác có thể do firmware không truyền quyền điều khiển USB cho macOS.<ul><li><code>UEFI -&gt; Quirks -&gt; bạn có thể đổi port usb để khắc pục lỗi nàyeleaseUsbOwnership -&gt; True</code></li><li>Hoặc bật XHCI Handoff</li></ul></li><li>Đôi khi việc đổi port usb cũng có thể giúp bạn khắc phục lỗi này</li><li>Đối với các cpu amd gen 15 và 16 thì cần add <a href="https://cdn.discordapp.com/attachments/566705665616117760/566728101292408877/XLNCUSBFix.kext.zip" target="_blank" rel="noreferrer noopener">XLNCUSBFix.kext</a><ul><li>Nếu như kext đó không hoạt động thì bạn có thể thử kext <a href="https://cdn.discordapp.com/attachments/249992304503291905/355235241645965312/StopSign-fixv5.zip" target="_blank" rel="noreferrer noopener">AMD StopSign-fixv5</a></li></ul></li><li>Ngoài ra hedt X299 cũng cần Enable Above4G Decoding</li><li>Thiếu USB port trong ACPI<ul><li>Các máy Intel các bạn sử dụng <a href="https://github.com/daliansky/OS-X-USB-Inject-All">usbinjectall</a></li><li>Còn đối với các CPU AMD thì bạn cần sử dụng SSDT-RHUB<ul><li>chọn <code>7.usb reset</code> trong SSDT-Time</li></ul></li></ul></li></ul></li><li>Sata issue:<ul><li>Xem chi tiết <a href="https://heavietnam.ga/2021/12/06/xxxxi-patch-sata-controller/">tại đây</a>.</li></ul></li></ul>



<h2>Kernel panic with <code>IOPCIFamily</code> trên hedt X99</h2>



<ul><li>Bật các mục sau trong config:<ul><li>AppleCpuPmCfgLock</li><li>AppleXcpmCfgLock</li><li>AppleXcpmExtraMsrs</li></ul></li><li>Thêm SSDT-UNC <a href="https://heavietnam.ga/2022/03/10/ssdt-recomend/">tại đây</a></li></ul>



<h2>Stuck on or near&nbsp;<code>IOConsoleUsers: gIOScreenLock...</code>/<code>gIOLockState (3...</code></h2>



<ul><li>DGPU không support hãy disable nó đi theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/xxi-disable-dgpu/">tại đây</a></li><li>CSM bị tắt trong bios<ul><li>1 số laptop phải bật CSM</li></ul></li><li>Force tốc  độ PCIe 3.0 link</li><li>Check patch igpu theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/xii-patch-igpu/">tại đây</a><ul><li>Desktop UHD 630 có thể thử <code>00009B3E</code></li><li><code>-igfxmlr</code>&nbsp;boot-arg. Điều này cũng có thể giúp fix lỗi <code>Divide by Zero</code></li><li>igfxonln=1 boot-arg trên igpu coffelake+ từ 10.15.4+</li></ul></li></ul>



<h2>Scrambled Screen on laptops</h2>



<p>Enable <code>CSM</code> trong bios setting nó có thể có tên là <code>Boot legacy ROMs </code>hoặc vài setting legacy khác</p>



<h2 id="black-screen-after-ioconsoleusers-gioscreenlock-on-navi">Black screen after&nbsp;<code>IOConsoleUsers: gIOScreenLock...</code>&nbsp;on Navi</h2>



<ul><li>Thêm <code>agdpmod=pikera</code> add vào boot-arg</li><li>Thử thay đổi các display output khác.</li><li>Thử smbios MacPro7,1&nbsp;với boot-arg <code>agdpmod=ignore</code></li><li>Đối với máy MSI thì bạn hãy add patch sau vào <code>Kernel -&gt; Patch</code> (ở bigsur không yêu cầu bản vá này).</li></ul>



<pre class="wp-block-code"><code>Base:
Comment: Navi VBIOS Bug Patch
Count: 1
Enabled: YES
Find: 4154592C526F6D2300
Identifier: com.apple.kext.AMDRadeonX6000Framebuffer
Limit: 0
Mask:
MinKernel: 19.00.00
MaxKernel: 19.99.99
Replace: 414D442C526F6D2300
ReplaceMask:
Skip: 0</code></pre>



<h2>Kernel Panic&nbsp;<code>Cannot perform kext summary</code></h2>



<ul><li>Hãy chắc rằng bạn đã add kext chính trước khi add plugin<ul><li>Vì những plugin chỉ có file plist mà không chứa tệp thực thi nên cần pahỉ sử dụng với kext chính </li></ul></li><li>Không sử dụng nhiều kext giống nhau trong config.plist<ul><li>như voodooinput có thể xuất hiện trong kẽt i2c và cả pss2 nên bạn chỉ nên dùng 1 kext voodooinput và xóa cái còn lại trong kext kia</li></ul></li><li>Sử dụng phương pháp fix lỗi giống như <code>invalid frame pointer</code></li></ul>



<h2>Kernel Panic&nbsp;<code>AppleIntelMCEReporter</code></h2>



<p>Thêm kext <a href="https://github.com/acidanthera/bugtracker/files/3703498/AppleMCEReporterDisabler.kext.zip" target="_blank" rel="noreferrer noopener">AppleMCEReporterDisabler</a> vào EFI --> OC --> Kext hoặc EFI --> Clover --> kext --> other (snaps nếu ở OpenCore).</p>



<h2>Kernel Panic&nbsp;<code>AppleIntelCPUPowerManagement</code></h2>



<ul><li>Patch power manager <a href="https://heavietnam.ga/2021/09/29/vi-3fix-power-manager/">tại đây</a></li><li>Thêm kext <a href="https://www.mediafire.com/folder/rhjg943ja2cc1/NullCPUPowerManagement.kext">NullCPUPowerManagement</a></li><li>Hoặc bạn có thể enable <code>DummyPowerManagement</code> trong <code>Kernel -&gt; Emulate</code> (chỉ đối với opencore)</li><li>Ở 1 số các cpu thế hệ cũ cung có thể bị thiếu hpet hoặc xung đột irq<ul><li>Fix hpet theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/ii-patch-am-thanh-voi-apple-alc-with-patch-hpet/">tại đây</a></li><li>Force hpet</li></ul></li></ul>



<pre class="wp-block-code"><code>// add patch sau vào ACPI --&gt; Patch

Comment	String	Force HPET Online
Enabled	Boolean	YES
Count	Number	0
Limit	Number	0
Find	Data	A010934F53464C00
Replace	Data	A40A0FA3A3A3A3A3</code></pre>



<h2>Kernel Panic&nbsp;<code>AppleACPIPlatform</code>&nbsp;in 10.13</h2>



<figure class="wp-block-image size-full"><img width="1024" height="347" src="https://heavietnam.ga/wp-content/uploads/2022/04/image-1.png" alt="" class="wp-image-2916" srcset="https://heavietnam.ga/wp-content/uploads/2022/04/image-1.png 1024w, https://heavietnam.ga/wp-content/uploads/2022/04/image-1-768x260.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Bật <code>NormalizeHeaders</code> trong <code>ACPI -&gt; Quirks</code> </p>



<h2>macOS frozen right before login</h2>



<p>Thêm kext <a href="https://github.com/lvs1974/CpuTscSync" target="_blank" rel="noreferrer noopener">CpuTscSync</a> vào EFI --> OC --> kext hoặc EFI --> Clover --> kext --> other (snaps nếu là OpenCore).</p>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/asus-tsc.2397797f.png" alt=""/><figcaption>Lỗi 1</figcaption></figure>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/asus-tsc-2.029ce318.png" alt=""/><figcaption>Lỗi 2</figcaption></figure>



<h2>Keyboard works but trackpad does not</h2>



<p>Fix trackpad theo <a href="https://heavietnam.ga/2021/09/29/v-fix-trackpad/">link</a></p>



<h2 id="kextd-stall-0-appleacpicpu"><code>kextd stall[0]: AppleACPICPU</code></h2>



<p>Điều này là do macOS bị thiếu giả lập SMC hãy đảm bản bạn có những phần sau:</p>



<ul><li><a href="https://github.com/acidanthera/Lilu/releases">Lilu</a> và <a href="https://github.com/acidanthera/VirtualSMC/releases">VirtualSMC</a> trong EFI --> OC --> kext hoặc EFI --> Clover --> kext --> other (snaps nếu là OpenCore)</li><li>Nếu không được hãy thử sử dụng <a href="https://bitbucket.org/RehabMan/os-x-fakesmc-kozlek/downloads/">Fake-SMC</a> (không sử dụng cả 2 fake-smc và VirtualSMC)</li></ul>



<h2>Kernel Panic on <code>AppleIntelI210Ethernet</code></h2>



<p>Đối với những main Comet lake&nbsp;với card I225-V NIC có thể xảy ra panic do kext I210 . Để khắc phục bạn cần có PciRoot đúng với card ethernet. 1 số  đường dẫn phổ biến là </p>



<ul><li>PciRoot(0x0)/Pci(0x1C,0x1)/Pci(0x0, 0x0)<ul><li>đối với main Asus, Gigabyte và đây cũng là mặc định</li></ul></li><li>PciRoot(0x0)/Pci(0x1C,0x4)/Pci(0x0,0x0)<ul><li>được dùng để thay thế khi dường dẫn trên không hoạt động</li></ul></li></ul>



<p>Bạn cũng có thể sử dụng&nbsp;<a href="https://github.com/acidanthera/gfxutil/releases" target="_blank" rel="noreferrer noopener">gfxutil</a> để tìm PciRoot của card ethernet 1 cách thủ công:</p>



<pre class="wp-block-code"><code>&lt;kéo gfxutil vào terminal&gt; | grep -i "8086:15f3"
00:1f.6 8086:15f3 /PC00@0/GBE1@1F,6 = PciRoot(0x0)/Pci(0x1F,0x6)</code></pre>



<p>Ta sẽ dễ thấy PciRoot là PciRoot(0x0)/Pci(0x1F,0x6). Ta sẽ add PciRoot(0x0)/Pci(0x1F,0x6)|data| F2150000</p>



<h2>Kernel panic on &#8220;<code>Wrong CD Clock Frequency</code>&#8221; with Icelake laptop</h2>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/cd-clock.ad48e008.jpg" alt=""/></figure>



<p>Add boot-arg <code>-igfxcdc</code></p>



<h2>Kernel panic on &#8220;<code>cckprng_int_gen</code>&#8220;</h2>



<pre class="wp-block-code"><code>// full error
"cckprng_int_gen: generator has already been sealed"</code></pre>



<p>Có 2 khả năng dẫn đến lỗi</p>



<ul><li>Thiếu SMC<ul><li>add <a href="https://github.com/acidanthera/VirtualSMC/releases">VirtualSMC</a> vào EFI --> OC --> kext hoặc EFI --> Clover --> Kext --> other (snaps nếu dùng opencore)</li><li>sử dụng SSDT-CPUR không đúng<ul><li>chỉ sử dụng SSDT này trên B550 and A520</li><li>Không sử dụng SSDT này trên X570 (B450 or A320)</li></ul></li></ul></li></ul>



<h2>Stuck at&nbsp;<code>Forcing CS_RUNTIME for entitlement</code>&nbsp;in Big Sur</h2>



<figure class="wp-block-image"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/cs-stuck.bddc4a2d.jpg" alt="Credit to Stompy for image"/></figure>



<p>Đây thực sự không phải là lỗi. Chỉ vì quá trình này rất lâu để vượt qua mà nhiều người nghĩ đây là lỗi nhưng hãy kiên nhẫn và đừng tắt máy</p>



<h2>Stuck on&nbsp;<code>ramrod</code>(^^^^^^^^^^^^^)</h2>



<p>bị stuck ở ramrod có nghĩa là nó boot --> gặp lỗi --> reboot --> vòng lặp</p>



<p>Điều này có nghĩa là giả lặp smc của bạn đã bị hỏng có 2 cách khắc phục</p>



<ul><li>Cài đặt VirtualSMC và Lilu new version  kèm boot-arg <code>vsmcgen=1</code></li><li>Bạn cũng thể thử kext <a href="https://bitbucket.org/RehabMan/os-x-fakesmc-kozlek/downloads/">Fake-SMC</a> để thay thế</li></ul>



<h2 id="virtual-machine-issues">Virtual Machine Issues</h2>



<p>VMware 15 sẽ bị stuck ở <code>[EB|#LOG:EXITBS:START]</code>. Cách fix là nâng câp lên VMware 16</p>



<h2>Reboot on &#8220;<code>AppleUSBHostPort::createDevice: failed to create device</code>&#8221; on macOS 11.3+</h2>



<ul><li>Map usb theo link <a href="https://heavietnam.ga/2021/09/29/vi-1map-usb-intel-and-amd/">tại đây</a></li><li>Tắt <code>XhciPortLimit</code> ở  <code>Kernel -> Quirks</code> (ở 11.3+)</li></ul>



<h2>OC: Prelinked injection USBInjectAll.kext (USBInjectAll.kext) &#8211; Invalid Parameter</h2>



<p>Convert usb injectall về version 2018 của rehabman <a href="https://bitbucket.org/RehabMan/os-x-usb-inject-all/downloads/RehabMan-USBInjectAll-2018-1108.zip">tại đây</a></p>



<h2>Stuck on <code>CpuTscSync</code></h2>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/YtYrwMa.jpg" alt=""/></figure>



<p>Hãy xóa kext CpuTscSync đi sau đó (snaps nếu là opencore)  reboot</p>



<p><strong>Lưu ý: Tuy bài viết này dựa trên cách fix lỗi cho opencore. nhưng người dùng clover vẫn có thể áp dụng cách đọc lỗi và nguyên nhân dẫn đến lỗi vì về bản chất thì nguyên nhân dẫn đến lỗi của opencore và oc là giống nhau</strong></p>



<p><strong>Source tham khảo: <a href="https://dortania.github.io/OpenCore-Install-Guide/troubleshooting/extended/kernel-issues.html">Kernel Issues | OpenCore Install Guide (dortania.github.io)</a></strong></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/kernel-issue/">Kernel issue</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/09/kernel-issue/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>OpenCore Debug</title>
		<link>https://heavietnam.ga/2022/04/09/opencore-debug/</link>
					<comments>https://heavietnam.ga/2022/04/09/opencore-debug/#comments</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sat, 09 Apr 2022 08:24:55 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2905</guid>

					<description><![CDATA[<p>Đây là phiên bản giúp bạn xem lỗi và dễ dàng fix lỗi. B1: Tải OpenCorePKG version Debug tại đây. B2: Các bạn sẽ tiền hành thay các file sau vào bộ EFI đang sử dụng (nếu chưa có EFI thì build theo link tại đây). BOOTx64.efi EFI/OC/Drivers/ OpenRuntime.efi OpenCanopy.efi OpenCore.efi B3: chỉnh config.plist theo [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/opencore-debug/">OpenCore Debug</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Đây là phiên bản giúp bạn xem lỗi và dễ dàng fix lỗi.</p>



<p>B1: Tải OpenCorePKG version Debug <a href="https://github.com/acidanthera/OpenCorePkg/releases">tại đây</a>.</p>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/B1D8Wh7.png" alt=""/></figure>



<p>B2: Các bạn sẽ tiền hành thay các file sau vào bộ EFI đang sử dụng (nếu chưa có EFI thì build theo link tại <a href="https://heavietnam.ga/2020/11/23/cach-tao-efi-cho-opencore/">đây</a>).</p>



<ul><li><code>BOOTx64.efi</code></li><li><code>EFI/OC/Drivers/</code><ul><li><code>OpenRuntime.efi</code></li><li><code>OpenCanopy.efi</code></li></ul></li><li><code>OpenCore.efi</code></li></ul>



<p>B3: chỉnh<code> config.plist</code> theo sau:</p>



<ul><li>Misc<ul><li>AppleDebug: YES</li><li>ApplePanic: YES<ul><li>Thường dùng kèm với <code>keepsyms=1</code> trong boot-arg</li></ul></li><li>DisableWatchdog: YES</li><li>Target: 67 (khuyến khích nên chọn là 67).<ul><li>B1: Đọc bảng sau <br> <img src="https://i.imgur.com/0E1M5Gx.png"> </li><li>B2: Tiến hành cộng các giá trị bạn chọn lại với nhau.<ul><li>Ở đây mình sẽ cộng <code>0x01 + 0x02 + 0x40 = 0x43</code> </li></ul></li><li>B3: Convert kết quả nhận được từ hex sang decimal bằng Hackintool.<ul><li><code>0x43 = 67 <br> <img src="https://i.imgur.com/TrjH8yS.png"></code></li></ul></li></ul></li><li>DisplayLevel: 2147483714 (khuyến khích nên chọn 2147483714).<ul><li>B1: Đọc bản sau <br> <img src="https://i.imgur.com/jvDMN1k.png"> </li><li>B2: Cộng các giá trị bạn đã chọn. <ul><li><code>0x00000002 + 0x00000040 + 0x80000000 = 0x80000042</code> </li></ul></li><li>B3: Convert Hex to Decimal. <ul><li><code>0x80000042 = 2147483714</code> <br> <img src="https://i.imgur.com/kpFMyDR.png"></li></ul></li></ul></li></ul></li></ul>



<p>B4: Thêm <code>-v</code> vào <code>boot-arg</code></p>



<p>Như vậy là bạn đã có 1 bộ EFI Debug OpenCore (Clover cũng làm tương tự).</p>



<p><strong>Source tham khảo: <a href="https://dortania.github.io/OpenCore-Install-Guide/troubleshooting/debug.html#config-changes">OpenCore Debugging | OpenCore Install Guide (dortania.github.io)</a></strong></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/04/09/opencore-debug/">OpenCore Debug</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/04/09/opencore-debug/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>[EB&#124;#LOG:EXITBS:START]</title>
		<link>https://heavietnam.ga/2022/03/03/eblogexitbsstart/</link>
					<comments>https://heavietnam.ga/2022/03/03/eblogexitbsstart/#comments</comments>
		
		<dc:creator><![CDATA[nghilw]]></dc:creator>
		<pubDate>Thu, 03 Mar 2022 10:47:59 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2546</guid>

					<description><![CDATA[<p>Phần này sẽ được chia làm 3 phần: Vấn đề về booter Vấn đề về Patch Kernel Vấn đề về UEFI Vấn đề về máy ảo Lỗi liên quan&#160;đến booster Những nguyên nhân chính gây ra lỗi này là: DevirtualiseMmio Một vài vùng MMIO vẫn bắt buộc phải có để hoạt động bình thường, vì [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/03/03/eblogexitbsstart/">[EB|#LOG:EXITBS:START]</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Phần này sẽ được chia làm 3 phần:</p>



<ul><li>Vấn đề về booter</li><li>Vấn đề về Patch Kernel</li><li>Vấn đề về UEFI</li><li>Vấn đề về máy ảo</li></ul>



<h2><strong>Lỗi liên quan&nbsp;đến booster</strong></h2>



<p>Những nguyên nhân chính gây ra lỗi này là:</p>



<h3><strong>DevirtualiseMmio</strong></h3>



<ul><li> Một vài vùng MMIO vẫn bắt buộc phải có để hoạt động bình thường, vì vậy bạn cần phải loại những vùng này ở trong Booter -&gt; MMIOWhitelist hoặc là bạn phải tắt cái dòng config này luôn. Các bạn có thể xem ở đây: <a href="http://heavietnam.ga/2022/01/31/using-devirtualisemmio/">Using Devirtualise MMIO</a><ul><li> Đối với những bạn dùng mainboard chipset TRx40 của AMD thì hãy bật cái dòng config này</li></ul><ul><li> Đối với những bạn dùng Mainboard chipset X99 thì hãy tắt cái dòng config này vì nó có thể vô tác dụng đối với một số firmware</li></ul></li></ul>



<h3><strong>SetupVirtualMap</strong></h3>



<ul><li> Dòng config này là bắt buộc phỉa bật đối với hầu hết các firrmware, nếu không có nó thì máy các bạn sẽ dễ bị dính lỗi kernel pannic ở đây, vì vậy các bạn nên bật nó nếu như các bạn vẫn chưa bật nó trong config</li></ul>



<ul><li> Những máy nào có chipset Z390 hoặc cũ hơn thì bắt buộc phải bật cái này</li></ul>



<ul><li><strong>Tuy nhiên</strong>,&nbsp;một số firmware(chủ yếu là những firmware từ năm 2020 trở đi) sẽ không tương thích với cái setting này và làm cho máy bạn bị kernel pannic chảng hạn như:<ul><li> CPU Intel dòng Icelake</li></ul><ul><li> Chipset Intel dòng Commet Lake(B460, H470, Z490, vv)</li></ul><ul><li> Mainboard AMD chipset B550 ,A520(bao gồm cả chipset X570 với bios bản mới nhất)</li></ul><ul><li> Một số mainboard AMD chipset B450 và X470 cũng giống với những mainboard ở trên khi cập nhật bios lên bản mới nhất</li><li>Mainboard chipset TRx40 của AMD</li><li>Các máy ảo chẳng hạn như QEMU</li><li> Mainboard chipset X299 với bios từ năm 2020 trở đi (cái này cũng áp dụng cho những mainboard X299 với bản BIOS từ cuối năm 2019 và sau từ năm 2020 trở đi)</li></ul></li></ul>



<h3><strong>EnableWriteUnprotector</strong></h3>



<p>&nbsp;&nbsp;&nbsp;  Một vấn đề khác chính là macOS có thể đang bị xung đột với lại chức năng chống ghi từ CR0, để fix cái này chũng ta có 2 lựa chọn:</p>



<ul><li> Nếu frmware của máy các ban hỗ trợ MATs (firmware tù năm 2018 trở đi)<ul><li> EnableWriteUnprotector -> False</li><li> RebuildAppleMemoryMap -> True</li><li> SyncRuntimePermissions -> True</li></ul></li><li> Đối với những máy có firmware cũ hơn:<ul><li> EnableWriteUnprotector -> True</li><li> RebuildAppleMemoryMap -> False</li><li> SyncRuntimePermissions -> True</li></ul></li></ul>



<p> Lưu ý: Một vài laptop (ví dụ như Dell Inspiron 5370) mặc dù có hỗ trợ MATs nhưng chũng vẫn bị lỗi khi boot lên, đối với nhũng máy như thế này các bạn có 2 lựa chọn:</p>



<ul><li> Boot máy với setting của máy có firrmware cũ hơn (*Đối với những máy có firmware cũ hơn)</li></ul>



<ul><li> Bật DevirtualiseMmio và làm theo <a href="https://heavietnam.ga/2022/01/31/using-devirtualisemmio/">Using DevirtualiseMmio</a></li></ul>



<p>Về vấn đề hỗ trợ MATs những firmware chống lại EDK 2018đã hỗ trợ MATs và nhều OEM đã support nó từ thời laptop Skylake(2016) vấn đề chỉ là chũng ta không rx liệu các OEM đã cập nhật firrmware đề hỗ trợ tính năng này hay chưa. Để kiểm tra xem amsy các bạn có hỗ tợ MATS hay không, các bạn có thể dùng tính năng lấy log của OpenCore &nbsp;&nbsp;</p>



<p><code>OCABC: MAT support is 1</code></p>



<p>*Lưu ý: &nbsp;có nghĩa là firrmware của máy các bạn hỗ trợ MAT còn 0 có nghĩ là nó không hỗ trợ</p>



<h2><strong>Lỗi liên quan đến</strong><strong>&nbsp;</strong><strong>Patch Kernel</strong>&nbsp;</h2>



<p>Lỗi liên quan đến cái này sẽ được phân ra làm 2 giữa Intel và AMD</p>



<h3> AMD</h3>



<p>     Thiếu các <a href="https://github.com/AMD-OSX/AMD_Vanilla">patch kernel</a> (chỉ áp dụng cho CPU AMD, hãy đảm bảo là chũng là nhũng patch OpenCore chứ không phải Clover). Clover sử dụng MatchOS trong khi OpenCore dùng MinKernel and Maxkernel)</p>



<p><strong>     Lưu ý là những bản patch cũng gây ra những lỗi tương tự nên các bạn hãy đảm bảo rằng các bạn đang dùng bản patch mới nhất cho AMD OS X</strong></p>



<h3> Intel</h3>



<ul><li>AppleXcpmCfgLock và AppleCpuPmCfgLock</li><li>Nếu thiếu patch CFG hoặc XCPM thì các bạn hãy bật AppleXcpmCfgLock và AppleCpuPmCfgLock trong config<ul><li> Các máy dùng CPU Haswell và mới hơn chỉ cần AppleXcpmCfgLock &nbsp;&nbsp;&nbsp;</li><li> Các máy dùng CPU Ivy Bridge và cũ hơn chỉ cần AppleCpuPmCfgLock</li><li> Các máy dùng CPU Broadwell và cũ hơn cần phải bật AppleCpuPmCfgLock khi các bạn chạy OSX 10.10 trở xuống</li></ul></li></ul>



<p><strong>Ngoài ra các bạn co thể tắt hoàn toàn CFG-Lock: Fixing CFG Lock</strong></p>



<p>AppleXcpmExtraMsrs Có thể bắt buộc, seting này thường chỉ dành cho các CPU như Pentinum, HEDT và một số các máy khác có CPU không được hỗ trợ chĩnh thức trong macOS</p>



<ul><li>Các CPU Intel đời rất cũ:<ul><li>Đối với macOS Big Sur, nhiều firmware gặp vấn đề trong việc các định số nhân CPU và khi đó sẽ gặp kernel pannic sớm nên không thể in lỗi này lên màn hình . Thông qua serial, các bạn có thể thấy nó báo như sau: <code>max_cpus_from_firmware not yet initialized</code></li><li>Cách giải quyết:<ul><li>Bật AvoidRuntimeDefrag ở trong Booter -&gt; Quirks</li><li>Cách này sẽ hoạt động đối với hầu hết các firmware</li><li>Trong trường hợp các bạn đã làm cách trên những nó vẫn không fix được thfi các bạn hãy thêm như sau vào mục Kernel -&gt; Patch</li></ul></li></ul></li></ul>



<figure class="wp-block-image is-style-default"><img alt=""/></figure>





<h2>Lỗi liên quan đến UEFI</h2>



<ul><li>ProvideConsoleGop<ul><li>Bắt buộc phải có cho việc chuyển từ màn hình log của OpenCore. Đây từng là một phần trong AptioMemoryFix nhưng hiện tại thì tính năng này đã được chuyển sang dạng setting trong OpenCore.</li><li>Từ bản OpenCore version 0.5.6, tính năng này đã được bật từ động trong config.plist</li></ul></li></ul>



<ul><li>IgnoreInvalidFlexRatio<ul><li>Bắt buộc phải có đối với các CPU từ đời Broadwell trờ xuống, Không bắt buộc đối với CPU AMD và CPU Intel từ đời Skylake trờ lên</li></ul></li></ul>



<p>Sources: <a href="https://dortania.github.io/OpenCore-Install-Guide/troubleshooting/extended/kernel-issues.html#stuck-on-eb-log-exitbs-start">Dortania</a></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/03/03/eblogexitbsstart/">[EB|#LOG:EXITBS:START]</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/03/03/eblogexitbsstart/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Fixing KASLR</title>
		<link>https://heavietnam.ga/2022/01/31/using-devirtualisemmio/</link>
					<comments>https://heavietnam.ga/2022/01/31/using-devirtualisemmio/#comments</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Mon, 31 Jan 2022 01:57:05 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2432</guid>

					<description><![CDATA[<p>KASLR là gì? Nó là viết tắt của cụm từ Kernel address space layout randomization. Nó là 1 công cụ bảo mật của Apple làm cho những Hacker khó có thể tìm ra những object quan trọng trong bộ nhớ vì nó luôn thay đổi ngẫu nhiên sau mỗi lần khởi động chi tiết xem [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/01/31/using-devirtualisemmio/">Fixing KASLR</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h2>KASLR là gì?</h2>



<p>Nó là viết tắt của cụm từ <strong>Kernel address space layout randomization</strong>. Nó là 1 công cụ bảo mật của Apple làm cho những Hacker khó có thể tìm ra những object quan trọng trong bộ nhớ vì nó luôn thay đổi ngẫu nhiên sau mỗi lần khởi động chi tiết xem <a href="https://lwn.net/Articles/569635/">tại đây</a>.</p>



<p>Đối với những máy có memory maps nhỏ hoặc hoặc có quá nhiều device trong DSDT. Có thể sẽ có space cho kernel hoạt động nhưng cũng có thể sẽ có free space mà kernel không bao phủ tới. Vì thế ta sẽ không để macOS chọn 1 khu vực ngẫu nhiên để hoạt động trong mỗi lần reboot mà ta sẽ giới hạn khu vực bất kì mà chắc chắn nó sẽ hoạt động.</p>



<h2>Vậy khi nào cần Fix KASLR</h2>



<p>Thường khi boot macOS sẽ gặp các lỗi như sau: </p>



<pre class="wp-block-code"><code>Error allocating 0x1197b pages at 0x0000000017a80000 alloc type 2
Couldn't allocate runtime area

//hoặc

Only 244/256 slide values are usable!

//hoặc

panic(cpu 6 caller 0xffffff801fc057ba): a freed zone element has been modified in zone kalloc.4096: expected 0x3f00116dbe8a46f6 but found 0x3f00116d00000000</code></pre>



<h2>Chuẩn bị:</h2>



<p>B1: Tải OpenRuntime.efi (trong OpenCorePKG xem chi tiết <a href="https://heavietnam.ga/2020/11/23/cach-tao-efi-cho-opencore/" data-type="post" data-id="1885">tại đây</a>).</p>



<p>B2: Tải OpenShell.efi (xem cách tải OpenShell <a href="https://heavietnam.ga/2020/11/23/cach-tao-efi-cho-opencore/" data-type="post" data-id="1885">tại đây</a>).</p>



<p>B3: chỉnh config --> Booter theo sau:</p>



<ul><li>AvoidRuntimeDefrag: YES</li><li>DevirtualiseMmio: YES</li><li>EnableSafeModeSlide: YES</li><li>ProtectUefiServices: NO</li><li>ProvideCustomSlide: YES</li><li>RebuildAppleMemoryMap: YES</li></ul>



<h2>Setting BIOS</h2>



<p>B1: Update BIOS (khá quan trọng đặc biệt là Z390).</p>



<p>B2: Clear CMOS.</p>



<p>B3: Bật các option sau trong BIOS:</p>



<ul><li>Above4GDecoding (đảm bảo rằng Booter -&gt; Quirks -&gt; ResizeAppleGpuBars: 0).</li><li>Boot Options -&gt; Windows8.1/10 mode.</li><li>Disable các option không cần thiết trong bios (không cần thiết ở đây có nghĩa là bạn không sử dụng):<ul><li>CSM</li><li>Intel SGX</li><li>Parallel Port</li><li>Serial Port</li><li>iGPU</li><li>Thunderbolt</li><li>LED lighting</li><li>Legacy USB</li></ul></li></ul>



<h2>Tìm Slide Value</h2>



<p>B1: Bạn chọn OpenShell.efi tại picker của OpenCore.</p>



<p>B2: Ấn Enter hoặc đợi vài giây.</p>



<p>B3: Các bạn gõ lệnh:</p>



<pre class="wp-block-code"><code>//truy cập vào ổ đĩa

fs0:

// kiểm tra xem bạn có đang ở đúng đường dẫn mong muốn không nếu không có thể thử fs1:

ls

// tạo file memmap.txt

memmap &gt; memmap.txt</code></pre>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/uQQPkHc.jpg" alt=""/></figure>



<p>B4: Mở file memmap.txt ra ta sẽ được:</p>



<pre class="wp-block-code"><code>Type       Start            End              # Pages          Attributes
BS_Code    0000000000000000-0000000000007FFF 0000000000000008 000000000000000F
Available  0000000000008000-000000000005DFFF 0000000000000056 000000000000000F
BS_Data    000000000005E000-000000000005FFFF 0000000000000002 000000000000000F
BS_Code    0000000000060000-000000000009EFFF 000000000000003F 000000000000000F
RT_Data    000000000009F000-000000000009FFFF 0000000000000001 800000000000000F
Available  0000000000100000-0000000000FFFFFF 0000000000000F00 000000000000000F
LoaderData 0000000001000000-00000000010FFFFF 0000000000000100 000000000000000F
<strong>Available</strong>  <strong>0000000001100000</strong>-000000001FFFFFFF 000000000001EF00 000000000000000F
Reserved   0000000020000000-00000000201FFFFF 0000000000000200 000000000000000F
Available  0000000020200000-0000000040003FFF 000000000001FE04 000000000000000F
Reserved   0000000040004000-0000000040004FFF 0000000000000001 000000000000000F
Available  0000000040005000-00000000CD431FFF 000000000008D42D 000000000000000F
LoaderCode 00000000CD432000-00000000CD53AFFF 0000000000000109 000000000000000F
BS_Data    00000000CD53B000-00000000CE025FFF 0000000000000AEB 000000000000000F
Available  00000000CE026000-00000000CE220FFF 00000000000001FB 000000000000000F
BS_Data    00000000CE221000-00000000CE5C2FFF 00000000000003A2 000000000000000F
Available  00000000CE5C3000-00000000CE5D6FFF 0000000000000014 000000000000000F
BS_Data    00000000CE5D7000-00000000CE762FFF 000000000000018C 000000000000000F
LoaderCode 00000000CE763000-00000000CE7EAFFF 0000000000000088 000000000000000F
BS_Data    00000000CE7EB000-00000000D90E3FFF 000000000000A8F9 000000000000000F
Available  00000000D90E4000-00000000D96C3FFF 00000000000005E0 000000000000000F
BS_Code    00000000D96C4000-00000000D9762FFF 000000000000009F 000000000000000F
RT_Code    00000000D9763000-00000000D9767FFF 0000000000000005 800000000000000F
BS_Code    00000000D9768000-00000000D97C5FFF 000000000000005E 000000000000000F
ACPI_NVS   00000000D97C6000-00000000D9DC6FFF 0000000000000601 000000000000000F
RT_Code    00000000D9DC7000-00000000D9DC9FFF 0000000000000003 800000000000000F
BS_Code    00000000D9DCA000-00000000D9DE0FFF 0000000000000017 000000000000000F
RT_Code    00000000D9DE1000-00000000D9DE6FFF 0000000000000006 800000000000000F
BS_Code    00000000D9DE7000-00000000D9DE8FFF 0000000000000002 000000000000000F
RT_Code    00000000D9DE9000-00000000D9DF6FFF 000000000000000E 800000000000000F
BS_Code    00000000D9DF7000-00000000D9F4DFFF 0000000000000157 000000000000000F
RT_Code    00000000D9F4E000-00000000D9F51FFF 0000000000000004 800000000000000F
BS_Code    00000000D9F52000-00000000D9F9CFFF 000000000000004B 000000000000000F
RT_Code    00000000D9F9D000-00000000D9FA3FFF 0000000000000007 800000000000000F
RT_Data    00000000D9FA4000-00000000D9FB0FFF 000000000000000D 800000000000000F
RT_Code    00000000D9FB1000-00000000D9FC2FFF 0000000000000012 800000000000000F
BS_Code    00000000D9FC3000-00000000D9FC5FFF 0000000000000003 000000000000000F
RT_Code    00000000D9FC6000-00000000D9FC7FFF 0000000000000002 800000000000000F
BS_Code    00000000D9FC8000-00000000D9FDEFFF 0000000000000017 000000000000000F
RT_Code    00000000D9FDF000-00000000D9FE4FFF 0000000000000006 800000000000000F
BS_Code    00000000D9FE5000-00000000D9FECFFF 0000000000000008 000000000000000F
RT_Code    00000000D9FED000-00000000D9FEDFFF 0000000000000001 800000000000000F
BS_Code    00000000D9FEE000-00000000D9FFCFFF 000000000000000F 000000000000000F
RT_Code    00000000D9FFD000-00000000D9FFDFFF 0000000000000001 800000000000000F
BS_Code    00000000D9FFE000-00000000DA008FFF 000000000000000B 000000000000000F
RT_Code    00000000DA009000-00000000DA00DFFF 0000000000000005 800000000000000F
BS_Code    00000000DA00E000-00000000DA039FFF 000000000000002C 000000000000000F
RT_Code    00000000DA03A000-00000000DA03AFFF 0000000000000001 800000000000000F
BS_Code    00000000DA03B000-00000000DA04AFFF 0000000000000010 000000000000000F
RT_Code    00000000DA04B000-00000000DA070FFF 0000000000000026 800000000000000F
BS_Code    00000000DA071000-00000000DA083FFF 0000000000000013 000000000000000F
RT_Code    00000000DA084000-00000000DA084FFF 0000000000000001 800000000000000F
BS_Code    00000000DA085000-00000000DA085FFF 0000000000000001 000000000000000F
RT_Code    00000000DA086000-00000000DA087FFF 0000000000000002 800000000000000F
BS_Code    00000000DA088000-00000000DA088FFF 0000000000000001 000000000000000F
RT_Code    00000000DA089000-00000000DA08DFFF 0000000000000005 800000000000000F
BS_Code    00000000DA08E000-00000000DA0A2FFF 0000000000000015 000000000000000F
RT_Data    00000000DA0A3000-00000000DA102FFF 0000000000000060 800000000000000F
RT_Code    00000000DA103000-00000000DA11DFFF 000000000000001B 800000000000000F
RT_Data    00000000DA11E000-00000000DA120FFF 0000000000000003 800000000000000F
RT_Data    00000000DA121000-00000000DA127FFF 0000000000000007 800000000000000F
RT_Data    00000000DA128000-00000000DA128FFF 0000000000000001 800000000000000F
RT_Data    00000000DA129000-00000000DA147FFF 000000000000001F 800000000000000F
Reserved   00000000DA148000-00000000DA4ADFFF 0000000000000366 000000000000000F
Reserved   00000000DA4AE000-00000000DA647FFF 000000000000019A 000000000000000F
ACPI_NVS   00000000DA648000-00000000DA70DFFF 00000000000000C6 000000000000000F
ACPI_NVS   00000000DA70E000-00000000DA8C7FFF 00000000000001BA 000000000000000F
ACPI_Recl  00000000DA8C8000-00000000DA8CCFFF 0000000000000005 000000000000000F
BS_Data    00000000DA8CD000-00000000DA8CDFFF 0000000000000001 000000000000000F
ACPI_NVS   00000000DA8CE000-00000000DA910FFF 0000000000000043 000000000000000F
BS_Data    00000000DA911000-00000000DAA5CFFF 000000000000014C 000000000000000F
BS_Code    00000000DAA5D000-00000000DACF6FFF 000000000000029A 000000000000000F
BS_Data    00000000DACF7000-00000000DAD06FFF 0000000000000010 000000000000000F
BS_Code    00000000DAD07000-00000000DAD18FFF 0000000000000012 000000000000000F
BS_Data    00000000DAD19000-00000000DAD1FFFF 0000000000000007 000000000000000F
RT_Data    00000000DAD20000-00000000DAFF3FFF 00000000000002D4 800000000000000F
BS_Data    00000000DAFF4000-00000000DAFFFFFF 000000000000000C 000000000000000F
<strong>Available</strong>  <strong>0000000100000000</strong>-000000011F1FFFFF 000000000001F200 000000000000000F
Reserved   00000000DBC00000-00000000DFDFFFFF 0000000000004200 8000000000000000
MMIO       00000000F8000000-00000000FBFFFFFF 0000000000004000 8000000000000001
MMIO       00000000FEC00000-00000000FEC00FFF 0000000000000001 8000000000000001
MMIO       00000000FED00000-00000000FED03FFF 0000000000000004 8000000000000001
MMIO       00000000FED1C000-00000000FED1FFFF 0000000000000004 8000000000000001
MMIO       00000000FEE00000-00000000FEE00FFF 0000000000000001 8000000000000001
MMIO       00000000FF000000-00000000FFFFFFFF 0000000000001000 8000000000000001
 
  Reserved  :         18,689 Pages (76,550,144 Bytes)
  LoaderCode:            401 Pages (1,642,496 Bytes)
  LoaderData:            256 Pages (1,048,576 Bytes)
  BS_Code   :          1,613 Pages (6,606,848 Bytes)
  BS_Data   :         47,748 Pages (195,575,808 Bytes)
  RT_Code   :            146 Pages (598,016 Bytes)
  RT_Data   :            876 Pages (3,588,096 Bytes)
  ACPI_Recl :              5 Pages (20,480 Bytes)
  ACPI_NVS  :          2,244 Pages (9,191,424 Bytes)
  MMIO      :         20,490 Pages (83,927,040 Bytes)
  MMIO_Port :              0 Pages (0 Bytes)
  PalCode   :              0 Pages (0 Bytes)
  Available :        969,334 Pages (3,970,392,064 Bytes)
  Persistent:              0 Pages (0 Bytes)
              -------------- 
Total Memory:          3,994 MB (4,188,663,808 Bytes)
</code></pre>



<p>B5: Bây giờ ta sẽ tiến hành chuyển giá trị thành Slide value chú ý vào giá trị <code>Available</code> lớn nhất ở cột <code>start</code> (chuyển sang decimal để so sánh).</p>



<p>B6: Các bạn sẽ thực hiện tính toán theo công thức (chuyển sang decimal để tính toán).</p>



<pre class="wp-block-code"><code>(HEX - 0x100000)/0x200000 = Slide Value in HEX

(DECIMAL - 0x100000)/0x200000 = Slide Value in decimal

(0000000100000000 - 0x100000)/0x200000

// convert hex to decimal 

(4294967296 - 1048576)/2097152 = 2047,5</code></pre>



<figure class="wp-block-image size-large"><img src="https://i.imgur.com/LiarwbH.png" alt=""/></figure>



<p>B7: Nhưng con số này quá lớn (<strong>&gt; 256</strong>) vì vậy ta cần phải hạ xuống các <code>Available</code> có giá trị nhỏ hơn cho đến khi bé hơn hoặc bằng 256.</p>



<p>B8: Ta sẽ thử với <code>0000000001100000</code> covert to decimal: <code>17825792</code> ta được kết quả là 8.</p>



<p>B9: Add vào boot-arg tham số <code>slide=XXX</code> (ở đây ta sẽ có là s<code>lide=8</code>).</p>



<p>B10: Reboot.</p>



<h3><strong>Lưu ý:</strong></h3>



<p> Ở 1 số máy sẽ nhận được slide value rất nhỏ như <code>slide=-0.379150390625</code> đối với trưởng hợp này ta sẽ đặt <code>slide=0</code>.</p>



<h2>Using DevirtualiseMmio</h2>



<p>Đối với 1 số main như Z390 và hầu hết dòng HEDT chúng ta cần lập 1 danh sách trắng. Đó là lúc MmioWhitelist phát huy tác dụng. Với <strong>DevirtualiseMmio</strong> và <strong>ProvideCustomSlide</strong> bạn vừa có thể bảo mật lại vừa có thể Boot, 1 combo hoàn hảo.</p>



<p>B1: Tạo 1 EFI Debug theo hướng dẫn <a href="https://heavietnam.ga/forum/topic/opencore-debugging/">tại đây</a> (nhớ enable <code>DevirtualiseMmio</code>).</p>



<ul><li>Đối với clover các bản cũng build tương tự (sử dụng bản clover debug) để dump được log file các bạn sẽ dùng hackintool  &#8211;> log </li></ul>



<p>B2: Bạn sẽ nhận được 1 file log mở nó ra và ta sẽ có:</p>



<pre class="wp-block-code"><code>21:495 00:009 OCABC: MMIO devirt start
<strong>21:499 00:003 OCABC: MMIO devirt 0x60000000 (0x10000 pages, 0x8000000000000001) skip 0
21:503 00:003 OCABC: MMIO devirt 0xFE000000 (0x11 pages, 0x8000000000000001) skip 0
21:506 00:003 OCABC: MMIO devirt 0xFEC00000 (0x1 pages, 0x8000000000000001) skip 0
21:510 00:003 OCABC: MMIO devirt 0xFED00000 (0x1 pages, 0x8000000000000001) skip 0
21:513 00:003 OCABC: MMIO devirt 0xFEE00000 (0x1 pages, 0x800000000000100D) skip 0
21:516 00:003 OCABC: MMIO devirt 0xFF000000 (0x1000 pages, 0x800000000000100D) skip 0</strong>
21:520 00:003 OCABC: MMIO devirt end, saved 278608 KB</code></pre>



<p>Bây giờ ta có 6 regions cần thêm vào danh sách trắng (in đậm).</p>



<p>Ta cần convert hex to decimal (có thể dùng Hackintool).</p>



<ul><li>MMIO devirt 0x60000000 -&gt; 1610612736</li><li>MMIO devirt 0xFE000000 -&gt; 4261412864</li><li>MMIO devirt 0xFEC00000 -&gt; 4273995776</li><li>MMIO devirt 0xFED00000 -&gt; 4275044352</li><li>MMIO devirt 0xFEE00000 -&gt; 4276092928</li><li>MMIO devirt 0xFF000000 -&gt; 4278190080</li></ul>



<figure class="wp-block-image size-large"><img src="https://imgur.com/4a65sZl.png" alt=""/></figure>



<p>B3: Add vào config ==&gt; booter ==&gt; MmioWhitelist.</p>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/OpenCore-Install-Guide/assets/img/mmio-white.0ee7b5c7.png" alt=""/></figure>



<p><strong>Source tham khảo: <a href="https://dortania.github.io/OpenCore-Install-Guide/extras/kaslr-fix.html">Fixing KASLR slide values | OpenCore Install Guide (dortania.github.io)</a></strong></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/01/31/using-devirtualisemmio/">Fixing KASLR</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/01/31/using-devirtualisemmio/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>XXXXII. Fix System Clocks on HEDT</title>
		<link>https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/</link>
					<comments>https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/#comments</comments>
		
		<dc:creator><![CDATA[admin]]></dc:creator>
		<pubDate>Sat, 22 Jan 2022 07:04:24 +0000</pubDate>
				<category><![CDATA[install hackintosh]]></category>
		<guid isPermaLink="false">https://heavietnam.ga/?p=2378</guid>

					<description><![CDATA[<p>Chuẩn bị: Dump DSDT theo hướng dẫn tại đây. Maciasl. SSDT-RTC0-RANGE. Xác định vấn đề: Các bạn cần xác định vấn đề của mình có thật sự cần dùng SSDT-RTC0 hay không. B1: Mở SSDT ra và ấn tổ hợp phím Command + F và gõ từ khóa PNP0B00 nhìn vào dòng _CRS. Chúng ta [...]</p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/">XXXXII. Fix System Clocks on HEDT</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<h2>Chuẩn bị:</h2>



<ul><li>Dump DSDT theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/xxvi-patch-dsdt-phan-1/">tại đây</a>.</li><li><a href="https://github.com/acidanthera/MaciASL/releases">Maciasl</a>.</li><li><a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/Source/SSDT-RTC0-RANGE.dsl">SSDT-RTC0-RANGE</a>.</li></ul>



<h2>Xác định vấn đề:</h2>



<p>Các bạn cần xác định vấn đề của mình có thật sự cần dùng SSDT-RTC0 hay không. </p>



<p>B1: Mở SSDT ra và ấn tổ hợp phím <code>Command + F</code> và gõ từ khóa <code>PNP0B00</code> nhìn vào dòng  <code>_CRS</code>.</p>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/Getting-Started-With-ACPI/assets/img/rtc-range-check.d964e9c9.png" alt=""/></figure>



<p>Chúng ta có: </p>



<pre class="wp-block-code"><code>                Name (_CRS, ResourceTemplate ()  // _CRS: Current Resource Settings
                {
                    IO (Decode16,
                        0x0070,             // Range Minimum 1
                        0x0070,             // Range Maximum 1
                        0x01,               // Alignment 1
                        0x02,               // Length 1
                       )
                    IO (Decode16,
                        0x0074,             // Range Minimum 2
                        0x0074,             // Range Maximum 2
                        0x01,               // Alignment 2
                        0x04,               // Length 2
                       )
                    IRQNoFlags ()
                        {8}
                })</code></pre>



<p>Các bạn để ý vào các dòng <meta charset="utf-8"><code>IRQNoFlags</code> (số vùng bao phủ) và 2 dòng <meta charset="utf-8"><code>IO (Decode16,</code> chúng ta có rtc bao phủ 8 vùng là 0x70 (0x007 chính là 0x70 do được viết bằng hex), 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77 ta có: </p>



<ul><li>Dòng io đầu tiên:<ul><li>Bắt đầu ở 0x70.</li><li>Bao gồm 2 vùng.</li><li>Chứa 0x70, 0x71.</li></ul></li><li>Dòng io thứ hai:<ul><li>Bắt đầu ở 0x74.</li><li>Bao gồm 4 vùng.</li><li>Chứa 0x74, 0x75, 0x76, 0x77.</li></ul></li></ul>



<p>Thiếu 0x72 và 0x73.</p>



<p>Ta cần sửa phạm vi ở dòng io đầu tiên thành 4.</p>



<h2>Tìm ACPI Path:</h2>



<p>B1: Mở DSDT lên và ấn <code>Command + F</code> </p>



<p>B2: Search các từ khóa sau:</p>



<ul><li><code>PNP0B00</code> : Dùng để tìm tên của Device RTC.</li><li><code>Name (_ADR, 0x001F0000)</code>: Dùng để tìm LPC Path (LowPinCount Path).</li><li><code>PNP0A08</code>: Dùng để tìm PCI Path (có thể có nhiều kết quả cùng xuất hiện hãy chọn cái đầu tiên).</li></ul>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/Getting-Started-With-ACPI/assets/img/rtc-name.afa4c3f4.png" alt=""/><figcaption>RTC Pathing</figcaption></figure>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/Getting-Started-With-ACPI/assets/img/lpc.bfa9cf23.png" alt=""/><figcaption>LPC Pathing</figcaption></figure>



<figure class="wp-block-image size-large"><img src="https://dortania.github.io/Getting-Started-With-ACPI/assets/img/pci0.4477f361.png" alt=""/><figcaption>PCI Pathing</figcaption></figure>



<p>Bây giờ chúng ta có các Path của ACPI là <code>rtc,lpc,pci0</code></p>



<h2>Edit SSDT:</h2>



<p>B1: Mở SSDT-RTC0 vừa tải ở bước chuẩn bị lên và sửa lại các Path như sau: </p>



<pre class="wp-block-code"><code>//Path mặc định sẽ là

PC00.LPC0.RTC

//chúng ta cần sửa lại là

PCI0.LPC.RTC </code></pre>



<p>B2: Rename trong SSDT:</p>



<pre class="wp-block-code"><code>//Trước khi rename

External (_SB_.PC00.LPC0, DeviceObj) &lt;- Rename 

External (_SB_.PC00.LPC0.RTC_, DeviceObj) &lt;- Rename 

Scope (_SB.PC00.LPC0) &lt;- Rename

//Sau khi rename

External (_SB_.PCI0.LPC, DeviceObj) &lt;- Renamed

Scope (_SB.PCI0.LPC.RTC) &lt;- Renamed

Scope (_SB.PCI0.LPC) &lt;- Renamed</code></pre>



<p>B3: Tiếp theo search <code>device(ACPI000E)</code> ( hoặc <meta charset="utf-8"><code>ACPI000E</code> ) Nếu DSDT của bạn có dòng này thì </p>



<pre class="wp-block-code"><code>  /* &lt;- xóa nó trong ssdt
  Scope (RTC)
        {
            Method (_STA, 0, NotSerialized)  // _STA: Status
            {
                If (_OSI ("Darwin"))
                {
                    Return (Zero)
                }
                Else
                {
                    Return (0x0F)
                }
            }
        }
  */ &lt;- xóa nó trong ssdt

// Nếu không có thì xóa luôn phần ghi chú này trong ssdt</code></pre>



<p>B4: Chúng ta có phần này:</p>



<pre class="wp-block-code"><code>            Name (_CRS, ResourceTemplate ()  // _CRS: Current Resource Settings
            {
                IO (Decode16,
                    0x0070,             // Range Minimum 1
                    0x0070,             // Range Maximum 1
                    0x01,               // Alignment 1
                    0x04,               // Length 1      (Expanded to include 0x72 and 0x73)
                    )
                IO (Decode16,
                    0x0074,             // Range Minimum 2
                    0x0074,             // Range Maximum 2
                    0x01,               // Alignment 2
                    0x04,               // Length 2
                    )
                IRQNoFlags ()
                    {8}
            })
// Sửa các giá trị theo phân tích ở bước xác định vấn đề ở đây mình đã sửa dòng io đầu tiên có phạm vi giá trị là 0x04</code></pre>



<figure class="wp-block-image size-large"><img src="https://imgur.com/oBdHjTa.png" alt=""/></figure>



<p>Chúng ta có: </p>



<figure class="wp-block-image size-large"><img src="https://imgur.com/pHiUOhF.png" alt=""/></figure>



<figure class="wp-block-image size-large"><img src="https://imgur.com/H0oVCx0.png" alt=""/></figure>



<figure class="wp-block-image size-large"><img src="https://imgur.com/id7Wk74.png" alt=""/></figure>



<p>B5: Save lại dưới dạng file aml theo hướng dẫn <a href="https://heavietnam.ga/2021/09/29/xxvii-patch-dsdt-phan-2/">tại đây</a>.</p>



<p>B6: Bỏ file SSDT vừa sửa vào EFI ==> OC ==> ACPI và Snapshot lại ( hoặc EFI ==> Clover ==> ACPI ) sau đó Restart.</p>



<p>Lưu ý: Source tham khảo: <a href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/awac-methods/manual-hedt.html#edits-to-the-sample-ssdt">Fixing System Clocks on HEDT: Manual | Getting Started With ACPI (dortania.github.io)</a> | <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/Source/SSDT-RTC0-RANGE.dsl">OpenCorePkg/SSDT-RTC0-RANGE.dsl at master · acidanthera/OpenCorePkg (github.com)</a></p>
<p>The post <a rel="nofollow" href="https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/">XXXXII. Fix System Clocks on HEDT</a> appeared first on <a rel="nofollow" href="https://heavietnam.ga">Heavietnam</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://heavietnam.ga/2022/01/22/fix-system-clocks-on-hedt/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
	</channel>
</rss>
