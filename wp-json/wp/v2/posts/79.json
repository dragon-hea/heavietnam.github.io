{"id":79,"date":"2021-09-29T04:29:07","date_gmt":"2021-09-29T04:29:07","guid":{"rendered":"https:\/\/heavietnam.ga\/?p=79"},"modified":"2021-10-18T00:41:24","modified_gmt":"2021-10-17T17:41:24","slug":"iv-patch-pin","status":"publish","type":"post","link":"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/","title":{"rendered":"IV. Patch pin"},"content":{"rendered":"<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_17 counter-hierarchy counter-decimal\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">Danh m\u1ee5c<\/p>\n<span class=\"ez-toc-title-toggle\"><a class=\"ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle\" style=\"display: none;\"><i class=\"ez-toc-glyphicon ez-toc-icon-toggle\"><\/i><\/a><\/span><\/div>\n<nav><ul class=\"ez-toc-list ez-toc-list-level-1\"><li class=\"ez-toc-page-1 ez-toc-heading-level-2\"><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/#P1_tim_hieu_thuat_ngu\" title=\"P1: t\u00ecm hi\u1ec3u thu\u1eadt ng\u1eef&nbsp;\">P1: t\u00ecm hi\u1ec3u thu\u1eadt ng\u1eef&nbsp;<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-2\"><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/#P2_tien_hanh\" title=\"P2 : ti\u1ebfn h\u00e0nh \">P2 : ti\u1ebfn h\u00e0nh <\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-2\"><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/#Cach_1_Dung_kext_ECENABLER\" title=\"C\u00e1ch 1: D\u00f9ng kext ECENABLER\">C\u00e1ch 1: D\u00f9ng kext ECENABLER<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-2\"><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/#Cach_2_Dung_cac_patch_san_cua_rehabman\" title=\"C\u00e1ch 2: D\u00f9ng c\u00e1c patch s\u1eb5n c\u1ee7a rehabman \">C\u00e1ch 2: D\u00f9ng c\u00e1c patch s\u1eb5n c\u1ee7a rehabman <\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-2\"><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/iv-patch-pin\/#Cach_3_Tien_hanh_thu_cong\" title=\"C\u00e1ch 3: Ti\u1ebfn h\u00e0nh th\u1ee7 c\u00f4ng\">C\u00e1ch 3: Ti\u1ebfn h\u00e0nh th\u1ee7 c\u00f4ng<\/a><\/li><\/ul><\/nav><\/div>\n\n<h2><span class=\"ez-toc-section\" id=\"P1_tim_hieu_thuat_ngu\"><\/span><strong><em>P1: t\u00ecm hi\u1ec3u thu\u1eadt ng\u1eef&nbsp;<\/em><\/strong><span class=\"ez-toc-section-end\"><\/span><\/h2>\n\n\n\n<ul><li>Tr\u01b0\u1edbc ti\u00ean ta ph\u1ea3i hi\u1ec3u nguy\u00ean t\u00e1c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a c\u00e1ch l\u00e0 sau \u0111\u00e2y<\/li><\/ul>\n\n\n\n<p>V\u00ec \u1edf c\u00e1c b\u1ea3n AppleACPIPlatform m\u1edbi n\u00f3 ko th\u1ec3 n\u00e0o truy c\u1eadp ch\u00ednh x\u00e1c v\u00e0o tr\u01b0\u1eddng EC c\u1ee5 th\u1ec3 l\u00e0 embedded controller<\/p>\n\n\n\n<p>n\u00ean n\u00f3 s\u1ebd g\u00e2y ra 1 s\u1ed1 l\u1ed7i khi s\u1eed d\u1ee5ng c\u00e1c kext hi\u1ec3n th\u1ecb ph\u1ea7n tr\u0103m pin n\u00ean b\u1ea1n ph\u1ea3i ti\u1ebfn h\u00e0nh s\u1eeda \u0111\u1ed5i dsdt \u0111\u1ec3 n\u00f3 nh\u1eadn ch\u00ednh x\u00e1c m\u1eb7c d\u00f9 b\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng c\u00e1c b\u1ea3n <meta charset=\"utf-8\">AppleACPIPlatform c\u0169 h\u01a1n ( Snow Leopard ) nh\u01b0ng v\u00ec c\u00e1c cpu ivybirdge + c\u00f3 h\u1ed7 tr\u1ee3 t\u00ednh n\u0103ng qu\u1ea3n l\u00fd n\u0103ng l\u01b0\u1ee3ng n\u00ean m\u00ecnh khuy\u00ean c\u00e1c b\u1ea1 n\u00ean d\u00f9ng b\u1ea3n m\u1edbi nh\u1ea5t \u0111\u1ec3 l\u00e0m \u0111i\u1ec1u \u0111\u00f3 ch\u00fang ta c\u1ea7n thay \u0111\u1ed5i c\u00e1c tr\u01b0\u1eddng trong ec th\u00e0nh 8 bit \u0111\u1ec3 c\u00f3 th\u1ec3 truy c\u1eadp c\u00f9ng 1 l\u00fac v\u00e0 b\u00e2y gi\u1edd ti\u1ebfn h\u00e0nh th\u00f4i<\/p>\n\n\n\n<h2><span class=\"ez-toc-section\" id=\"P2_tien_hanh\"><\/span><strong><em>P2 : ti\u1ebfn h\u00e0nh<\/em><\/strong> <span class=\"ez-toc-section-end\"><\/span><\/h2>\n\n\n\n<h2><span class=\"ez-toc-section\" id=\"Cach_1_Dung_kext_ECENABLER\"><\/span><strong>C\u00e1ch 1: D\u00f9ng kext ECENABLER<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h2>\n\n\n\n<p>Khi l\u00e0m c\u00e1ch n\u00e0y 90% l\u00e0 nh\u1eadn pin<\/p>\n\n\n\n<p><strong>B1:<\/strong> T\u1ea3i kext ECEnabler t\u1eeb ngu\u1ed3n <a href=\"https:\/\/github.com\/1Revenger1\/ECEnabler\/releases\">Releases \u00b7 1Revenger1\/Enabler \u00b7 GitHub<\/a>&nbsp; v\u00e0 b\u1ecf v\u00e0o th\u01b0 m\u1ee5c EFI \u21d2 OC ho\u1eb7c EFI ==&gt; CLOVER ==&gt; KEXT ==&gt; OTHER<\/p>\n\n\n\n<p><strong>B2<\/strong> Snapshot config<\/p>\n\n\n\n<p><strong>B3<\/strong>: c\u00e1c b\u1ea1n t\u1ea3i smc battery b\u1ecf v\u00f4 m\u1ee5c kext snaps l\u1ea1i ( links \u0111\u00e2y nh\u00e9 <a href=\"https:\/\/github.com\/acidanthera\/virtualsmc\/releases\">Releases \u00b7 acidanthera\/VirtualSMC \u00b7 GitHub<\/a> )<\/p>\n\n\n\n<p><strong>B4<\/strong>: reboot v\u00e0 t\u1eadn h\u01b0\u1edfng<\/p>\n\n\n\n<h2><span class=\"ez-toc-section\" id=\"Cach_2_Dung_cac_patch_san_cua_rehabman\"><\/span><strong>C\u00e1ch 2: D\u00f9ng c\u00e1c patch s\u1eb5n c\u1ee7a rehabman <\/strong><span class=\"ez-toc-section-end\"><\/span><\/h2>\n\n\n\n<p>B1: c\u00e1c b\u1ea1n c\u1ea7n rename EC \u0111\u1ec3 c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u1edf catalina+ theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvii-patch-dsdt-phan-2\/\">t\u1ea1i \u0111\u00e2y<\/a> <\/p>\n\n\n\n<p>B2: c\u00e1c b\u1ea1n down patch ph\u00f9 h\u1ee3p v\u1edbi m\u00e1y c\u1ee7a c\u00e1c b\u1ea1n <a href=\"https:\/\/github.com\/RehabMan\/Laptop-DSDT-Patch\/tree\/master\/battery\">t\u1ea1i \u0111\u00e2y<\/a> <\/p>\n\n\n\n<p>H\u1ea7u h\u1ebft c\u00e1c m\u00e1y asus v\u00e0 lenovo \u0111\u1ec1u c\u00f3 patch t\u1ea1i \u0111\u00e2y <\/p>\n\n\n\n<p>B3: xem patch n\u00e0o h\u1ed7 tr\u1ee3 m\u00e1y c\u1ee7a b\u1ea1n <\/p>\n\n\n\n<ul><li>C\u00e1c b\u1ea1n v\u00e0o c\u00e1c patch ph\u00f9 h\u1ee3p v\u1edbi model m\u00e1y <\/li><li>V\u00e0 nh\u00ecn xu\u1ed1ng d\u00f2ng working <\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image\"><img src=\"https:\/\/lh5.googleusercontent.com\/3f9UFToVOlHMlbvcR3Dhw7mmzks3wz6spyFUlhVzf9MbUW20gUIkNc5SqjugE4iDEEDKxm00NB1KRlpLvMys_T08tuSU_ZAD7-wCh5zvTIriY0rL2O5zbI_34jE9XOviY81apmgo=s0\" alt=\"\"\/><\/figure>\n\n\n\n<p>B4: down patch v\u1ec1 v\u00e0 down maciasl <a href=\"https:\/\/bitbucket.org\/RehabMan\/os-x-maciasl-patchmatic\/downloads\/\">t\u1ea1i \u0111\u00e2y<\/a> <\/p>\n\n\n\n<p>B5: c\u00e1c b\u1ea1n dump dsdt v\u00e0 bi\u00ean d\u1ecbch  theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvi-patch-dsdt-phan-1\/\">t\u1ea1i \u0111\u00e2y<\/a><\/p>\n\n\n\n<p>B6: apply c\u00e1c patch theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvii-patch-dsdt-phan-2\/\">t\u1ea1i \u0111\u00e2y<\/a> <\/p>\n\n\n\n<p><strong>L\u01b0u \u00fd : khi l\u00e0m theo c\u00e1ch n\u00e0y th\u00ec l\u00fac c\u00e1c b\u1ea1n update bios s\u1ebd ph\u1ea3i l\u00e0m l\u1ea1i n\u1ebfu kh\u00f4ng mu\u1ed1n l\u00e0m l\u1ea1i th\u00ec c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 tr\u00edch dsdt theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxviii-patch-dsdt-phan-3\/\" target=\"_blank\" rel=\"noreferrer noopener\">t\u1ea1i \u0111\u00e2y<\/a><\/strong><\/p>\n\n\n\n<h2><span class=\"ez-toc-section\" id=\"Cach_3_Tien_hanh_thu_cong\"><\/span><strong>C\u00e1ch 3: Ti\u1ebfn h\u00e0nh th\u1ee7 c\u00f4ng<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h2>\n\n\n\n<p>\u1ede \u0111\u00e2y m\u00ecnh s\u1ebd vi\u1ebft patch b\u1eb1ng c++ thay v\u00ec s\u1eeda tr\u1ef1c ti\u1ebfp \u0111\u1ec3 khi c\u00e1c b\u1ea1n update bios ch\u1ec9 c\u1ea7n apply v\u00e0o l\u00e0 \u0111c  ho\u1eb7c c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 s\u1eeda tr\u1ef1c ti\u1ebfp sau \u0111\u00f3 tr\u00edch dsdt ra th\u00e0nh ssdt theo h\u01b0\u1edbng d\u1eabn <strong><a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxviii-patch-dsdt-phan-3\/\" target=\"_blank\" rel=\"noreferrer noopener\">t\u1ea1i \u0111\u00e2y<\/a><\/strong><\/p>\n\n\n\n<p>B1: dump dsdt theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvi-patch-dsdt-phan-1\/\">t\u1ea1i \u0111\u00e2y<\/a><\/p>\n\n\n\n<p>B2: bi\u00ean d\u1ecbch dsdt theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvi-patch-dsdt-phan-1\/\">t\u1ea1i \u0111\u00e2y <\/a><\/p>\n\n\n\n<p>B2: c\u00e1c b\u1ea1n c\u1ea7n rename EC \u0111\u1ec3 c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u1edf catalina+ theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvii-patch-dsdt-phan-2\/\">t\u1ea1i \u0111\u00e2y<\/a><\/p>\n\n\n\n<p>B3: c\u00e1c b\u1ea1n \u1ea5n command+F r\u1ed3i search t\u1eeb kh\u00f3a &#8220;EmbeddedControl&#8221; ( \u1edf \u0111\u00e2y do m\u00e1y m\u00ecnh ch\u00ed c\u00f3 1 tr\u01b0\u1eddng <meta charset=\"utf-8\">EmbeddedControl nh\u01b0ng c\u00f3 nhi\u1ec1u m\u00e1y c\u00f3 nhi\u1ec1u tr\u01b0\u1eddng <meta charset=\"utf-8\">EmbeddedControl th\u00ec c\u00e1c b\u1ea1n c\u0169ng l\u00e0m t\u01b0\u01a1ng t\u1ef1 nh\u00e9 )<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/cG1YLHc.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>B4: c\u00e1c b\u1ea1n ch\u00fa \u00fd v\u00e0o &#8220;ECF2&#8221; v\u00e0 ti\u1ebfp t\u1ee5c search <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/oQBYl0c.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>\u1edf \u0111\u00e2y ta th\u1ea5y \u0111o\u1ea1n m\u00e3 tr\u00ean c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 255 byte ( 0xFF=255 )<\/p>\n\n\n\n<p>B5: C\u00e1c b\u1ea1n nh\u00ecn xu\u1ed1ng d\u01b0\u1edbi tr\u01b0\u1edfng ch\u00fang ta \u0111\u00e3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c ta c\u00f3 th\u1ec3 th\u1ea5y c\u00e1c v\u00f9ng khai b\u00e1o nh\u01b0 l\u00e0 BDN0, 56, c\u00f3 ngh\u0129a l\u00e0 v\u00f9ng BDN0 c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 56 bit nh\u01b0 \u0111\u00e3 n\u00f3i \u1edf tr\u00ean c\u00e1c v\u00f9ng l\u1edbn h\u01a1n 8 bit l\u00e0 c\u00e1c v\u00f9ng c\u1ea7n \u0111\u01b0\u1ee3c s\u1eeda ch\u1eefa n\u00ean c\u00e1c v\u00f9ng nh\u1ecf h\u01a1n 8 bit ho\u1eb7c b\u1eb1ng c\u00f3 th\u1ec3 b\u1ecf qua <\/p>\n\n\n\n<p>B6: b\u1ea1n ti\u1ebfp t\u1ee5c t\u00ecm ki\u1ebfm t\u1eeb kh\u00f3a BDN0 <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/1l9QYyP.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>\u1edf \u0111\u00e2y c\u00f3 ngh\u0129a l\u00e0 c\u00e1c tr\u01b0\u1eddng BDN0 \u0111\u01b0\u1ee3c L\u01b0u tr\u1eef v\u00e0o b\u1ed9 nh\u1edb \u0111\u1ec7m BDN do \u0111\u00e2y l\u00e0 1 tr\u01b0\u1eddng 56 bit \u0111\u1ed1i v\u1edbi c\u00e1c tr\u01b0\u1eddng 32 bit tr\u1edf xu\u1ed1ng s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef d\u01b0\u1edbi d\u1ea1ng s\u1ed1 nguy\u00ean. N\u1ebfu b\u1ea1n t\u00ecm 1 tr\u01b0\u1eddng l\u1edbn h\u01a1n 8 bit m\u00e0 kh\u00f4ng c\u00f3 c\u00e1c k\u1ebft qu\u1ea3 n\u00e0o kh\u00e1c t\u1ee9c l\u00e0 tr\u01b0\u1eddng \u0111\u00f3 ko \u0111\u01b0\u1ee3c dsdt s\u1eed d\u1ee5ng c\u00f3 th\u1ec3 b\u1ecf qua <\/p>\n\n\n\n<p>B7: C\u00e1c b\u1ea1n ti\u1ebfp t\u1ee5c  t\u00ecm c\u00e1c tr\u01b0\u1eddng nh\u01b0 v\u1eady ta \u0111\u01b0\u1ee3c <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>                        BDN0,   56,\n                        BCT0,   128,\n                        BDN1,   56,\n                        BCT1,   128,\n...\n                        BDC0,   16,\n                        BDC1,   16,\n                        BFC0,   16,\n                        BFC1,   16,\n...\n                        BDV0,   16,\n                        BDV1,   16,\n...\n                        BPR0,   16,\n                        BPR1,   16,\n\n                        BRC0,   16,\n                        BRC1,   16,\n                        BCC0,   16,\n                        BCC1,   16,\n                        CV01,   16,\n                        CV02,   16,\n                        CV03,   16,\n                        CV04,   16,\n                        CV11,   16,\n                        CV12,   16,\n                        CV13,   16,\n                        CV14,   16,\n...\n                        BMD0,   16,\n                        BMD1,   16,\n                        BPV0,   16,\n                        BPV1,   16,\n                        BSN0,   16,\n                        BSN1,   16,\n                        BCV0,   16,\n                        BCV1,   16,\n                        CRG0,   16,\n                        CRG1,   16,\n                        BTY0,   32,\n                        BTY1,   32,\n...\n                        CBT0,   16,\n                        CBT1,   16,<\/code><\/pre>\n\n\n\n<p>B8: Patch c\u00e1c tr\u01b0\u1eddng 16 bit v\u00e0 32 bit<\/p>\n\n\n\n<p>V\u00ec \u0111\u00e2y l\u00e0 2 tr\u01b0\u1eddng d\u1ec5 nh\u1ea5t :<\/p>\n\n\n\n<ul><li>Tr\u01b0\u1eddng 16 bit :<ul><li>B1: ta s\u1ebd thay tr\u01b0\u1eddng ch\u00ednh th\u00e0nh 2 tr\u01b0\u1eddng nh\u1ecf h\u01a1n b\u1eb1ng c\u00e1ch chia m\u1ed7i v\u00f9ng l\u00e0 8 bit b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1eb7t b\u1ea5t k\u00ec t\u00ean g\u00ec m\u00e0 b\u1ea1n mu\u1ed1n nh\u01b0ng kh\u00f4ng \u0111\u01b0\u1ee3c tr\u00f9ng v\u1edbi c\u00e1c t\u00ean \u0111\u00e3 c\u00f3 trong dsdt ( m\u1eb9o \u1edf \u0111\u00e2y l\u00e0 b\u1ea1n s\u1ebd l\u1ea5y t\u00ean c\u1ee7a tr\u01b0\u1eddng ch\u00ednh b\u1ecf \u0111i k\u00fd t\u1ef1 \u0111\u1ea7u ti\u00ean v\u00e0 th\u00eam sau l\u00e0 c\u00e1c s\u00f4 th\u1ee9 t\u1ef1 ) v\u00ed d\u1ee5 nh\u01b0 \u1edf \u0111\u00e2y m\u00ecnh c\u00f3 <\/li><\/ul><\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code>BDC0, 16 <\/code><\/pre>\n\n\n\n<p>th\u00ec ta s\u1ebd bi\u1ebfn \u0111\u1ed5i n\u00f3 th\u00e0nh<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>DC01, 8,\nDC02, 8,\n<\/code><\/pre>\n\n\n\n<p>ta s\u1ebd c\u00f3 code nh\u01b0 sau <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into device label EC code_regex BDC0,\\s+16, replace_matched begin DC01,8,DC02,8, end;\n<\/code><\/pre>\n\n\n\n<p>\u1edf \u0111\u00e2y c\u00f3 ngh\u0129a l\u00e0 t\u00ecm \u0111\u1ebfn device EC ( do \u1edf b\u01b0\u1edbc 1 c\u00e1c b\u1ea1n \u0111\u00e3 \u0111\u1ed5i t\u00ean r\u1ed3i ) v\u00e0 thay th\u1ebf BDC0, 16 th\u00e0nh DC01, 8 v\u00e0 DC02 ,8<\/p>\n\n\n\n<p>sau khi apply s\u1ebd \u0111\u01b0\u1ee3c nh\u01b0 h\u00ecnh <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/UeO8FcP.png\" alt=\"\"\/><\/figure>\n\n\n\n<ul><li>B2: khi complie ta s\u1ebd b\u1ecb l\u1ed7i v\u00ec BDC0 v\u1eabn c\u00f2n \u0111ang \u0111\u01b0\u1ee3c l\u01b0u ta s\u1ebd c\u1ea7n kh\u00e1c ph\u1ee5c \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch d\u00f9ng method B1B2<ul><li>\u0111\u1ea7u ti\u00ean add \u0111o\u1ea1n code sau v\u00e0o <\/li><\/ul><\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label B1B2 remove_entry;\ninto definitionblock code_regex . insert\nbegin\nMethod (B1B2, 2, NotSerialized) { Return(Or(Arg0, ShiftLeft(Arg1, 8))) }\\n\nend;<\/code><\/pre>\n\n\n\n<ul><li>Ti\u1ebfp theo c\u00e1c b\u1ea1n check l\u1ed7i v\u00e0 theo \u0111\u00f3 ta t\u00ecm \u0111c method c\u1ee7a ph\u1ea7n b\u1ecb l\u1ed7i <\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/DO8Z7R2.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>\u1ede \u0111\u00e2y ta c\u00f3 method c\u1ee7a ph\u1ea7n b\u1ecb l\u1ed7i l\u00e0 GBTI n\u00ean ta c\u00f3 \u0111o\u1ea1n code sau <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label GBTI code_regex \\(BDC0, replaceall_matched begin (B1B2(DC00,DC01), end;\n<\/code><\/pre>\n\n\n\n<p>sau khi add xong s\u1ebd \u0111\u01b0\u1ee3c nh\u01b0 h\u00ecnh<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/zVShZzb.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>V\u00e0 b\u00e2y gi\u1edd khi check l\u1ea1i ta s\u1ebd \u0111\u01b0\u1ee3c <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/pR3tQ5w.png\" alt=\"\"\/><\/figure>\n\n\n\n<ul><li>B3: c\u00e1c b\u1ea1n l\u00e0m t\u01b0\u01a1ng t\u1ef1 cho \u0111\u1ebfn khi h\u1ebft t\u1ea5t c\u1ea3 c\u00e1c tr\u01b0\u1eddng 16 bit ta \u0111\u01b0\u1ee3c<ul><li>chuy\u1ec3n c\u00e1c tr\u01b0\u1eddng v\u1ec1 8 bit<\/li><\/ul><\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code># 16-bit registers\ninto device label EC code_regex BDC0,\\s+16 replace_matched begin DC00,8,DC01,8 end;\ninto device label EC code_regex BDC1,\\s+16 replace_matched begin DC10,8,DC11,8 end;\ninto device label EC code_regex BFC0,\\s+16 replace_matched begin FC00,8,FC01,8 end;\ninto device label EC code_regex BFC1,\\s+16 replace_matched begin FC10,8,FC11,8 end;\ninto device label EC code_regex BDV0,\\s+16 replace_matched begin DV00,8,DV01,8 end;\ninto device label EC code_regex BDV1,\\s+16 replace_matched begin DV10,8,DV11,8 end;\ninto device label EC code_regex BPR0,\\s+16 replace_matched begin PR00,8,PR01,8 end;\ninto device label EC code_regex BPR1,\\s+16 replace_matched begin PR10,8,PR11,8 end;\ninto device label EC code_regex BRC0,\\s+16 replace_matched begin RC00,8,RC01,8 end;\ninto device label EC code_regex BRC1,\\s+16 replace_matched begin RC10,8,RC11,8 end;\ninto device label EC code_regex BCC0,\\s+16 replace_matched begin CC00,8,CC01,8 end;\ninto device label EC code_regex BCC1,\\s+16 replace_matched begin CC10,8,CC11,8 end;\ninto device label EC code_regex CV01,\\s+16 replace_matched begin CV10,8,CV11,8 end;\ninto device label EC code_regex CV02,\\s+16 replace_matched begin CV20,8,CV21,8 end;\ninto device label EC code_regex CV03,\\s+16 replace_matched begin CV30,8,CV31,8 end;\ninto device label EC code_regex CV04,\\s+16 replace_matched begin CV40,8,CV41,8 end;\ninto device label EC code_regex CV11,\\s+16 replace_matched begin CV50,8,CV51,8 end;\ninto device label EC code_regex CV12,\\s+16 replace_matched begin CV60,8,CV61,8 end;\ninto device label EC code_regex CV13,\\s+16 replace_matched begin CV70,8,CV71,8 end;\ninto device label EC code_regex CV14,\\s+16 replace_matched begin CV80,8,CV81,8 end;\ninto device label EC code_regex HPBA,\\s+16 replace_matched begin PBA0,8,PBA1,8 end;\ninto device label EC code_regex HPBB,\\s+16 replace_matched begin PBB0,8,PBB1,8 end;\ninto device label EC code_regex BMD0,\\s+16 replace_matched begin MD00,8,MD01,8 end;\ninto device label EC code_regex BMD1,\\s+16 replace_matched begin MD10,8,MD11,8 end;\ninto device label EC code_regex BPV0,\\s+16 replace_matched begin PV00,8,PV01,8 end;\ninto device label EC code_regex BPV1,\\s+16 replace_matched begin PV10,8,PV11,8 end;\ninto device label EC code_regex BSN0,\\s+16 replace_matched begin SN00,8,SN01,8 end;\ninto device label EC code_regex BSN1,\\s+16 replace_matched begin SN10,8,SN11,8 end;\ninto device label EC code_regex BCV0,\\s+16 replace_matched begin BV00,8,BV01,8 end;\ninto device label EC code_regex BCV1,\\s+16 replace_matched begin BV10,8,BV11,8 end;\ninto device label EC code_regex CRG0,\\s+16 replace_matched begin RG00,8,RG01,8 end;\ninto device label EC code_regex CRG1,\\s+16 replace_matched begin RG10,8,RG11,8 end;\ninto device label EC code_regex CBT0,\\s+16 replace_matched begin BT00,8,BT01,8 end;\ninto device label EC code_regex CBT1,\\s+16 replace_matched begin BT10,8,BT11,8 end;\n<\/code><\/pre>\n\n\n\n<ul><li>s\u1eeda \u0111\u1ed5i c\u00e1c thanh ghi <\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code># fix 16-bit methods\ninto method label GBTI code_regex \\(BDC0, replaceall_matched begin (B1B2(DC00,DC01), end;\ninto method label GBTI code_regex \\(BDC1, replaceall_matched begin (B1B2(DC10,DC11), end;\ninto method label GBTI code_regex \\(BFC0, replaceall_matched begin (B1B2(FC00,FC01), end;\ninto method label GBTI code_regex \\(BFC1, replaceall_matched begin (B1B2(FC10,FC11), end;\ninto method label BTIF code_regex \\(BFC0, replaceall_matched begin (B1B2(FC00,FC01), end;\ninto method label BTIF code_regex \\(BFC1, replaceall_matched begin (B1B2(FC10,FC11), end;\ninto method label ITLB code_regex \\(BFC1, replaceall_matched begin (B1B2(FC10,FC11), end;\ninto method label ITLB code_regex \\sBFC0, replaceall_matched begin B1B2(FC00,FC01), end;\ninto method label _Q09 code_regex \\(BRC0, replaceall_matched begin (B1B2(RC00,RC01), end;\ninto method label _Q09 code_regex \\sBFC0\\) replaceall_matched begin B1B2(FC00,FC01)) end;\ninto method label GBTI code_regex \\(BDV0, replaceall_matched begin (B1B2(DV00,DV01), end;\ninto method label GBTI code_regex \\(BDV1, replaceall_matched begin (B1B2(DV10,DV11), end;\ninto method label BTIF code_regex \\(BDV0, replaceall_matched begin (B1B2(DV00,DV01), end;\ninto method label BTIF code_regex \\(BDV1, replaceall_matched begin (B1B2(DV10,DV11), end;\ninto method label GBTI code_regex \\(BPR0, replaceall_matched begin (B1B2(PR00,PR01), end;\ninto method label GBTI code_regex \\(BPR1, replaceall_matched begin (B1B2(PR10,PR11), end;\ninto method label BTST code_regex \\sBPR0, replaceall_matched begin B1B2(PR00,PR01), end;\ninto method label BTST code_regex \\sBPR1, replaceall_matched begin B1B2(PR10,PR11), end;\ninto method label BTST code_regex \\(BPR0, replaceall_matched begin (B1B2(PR00,PR01), end;\ninto method label BTST code_regex \\(BPR1, replaceall_matched begin (B1B2(PR10,PR11), end;\ninto method label BTST code_regex \\(BRC0, replaceall_matched begin (B1B2(RC00,RC01), end;\ninto method label BTST code_regex \\(BRC1, replaceall_matched begin (B1B2(RC10,RC11), end;\ninto method label GBTI code_regex \\(BRC0, replaceall_matched begin (B1B2(RC00,RC01), end;\ninto method label GBTI code_regex \\(BRC1, replaceall_matched begin (B1B2(RC10,RC11), end;\ninto method label _Q09 code_regex \\(BRC0, replaceall_matched begin (B1B2(RC00,RC01), end;\ninto method label GBTI code_regex \\(BCC0, replaceall_matched begin (B1B2(CC00,CC01), end;\ninto method label GBTI code_regex \\(BCC1, replaceall_matched begin (B1B2(CC10,CC11), end;\ninto method label GBTI code_regex \\(CV01, replaceall_matched begin (B1B2(CV10,CV11), end;\ninto method label GBTI code_regex \\(CV02, replaceall_matched begin (B1B2(CV20,CV21), end;\ninto method label GBTI code_regex \\(CV03, replaceall_matched begin (B1B2(CV30,CV31), end;\ninto method label GBTI code_regex \\(CV04, replaceall_matched begin (B1B2(CV40,CV41), end;\ninto method label GBTI code_regex \\(CV11, replaceall_matched begin (B1B2(CV50,CV51), end;\ninto method label GBTI code_regex \\(CV12, replaceall_matched begin (B1B2(CV60,CV61), end;\ninto method label GBTI code_regex \\(CV13, replaceall_matched begin (B1B2(CV70,CV71), end;\ninto method label GBTI code_regex \\(CV14, replaceall_matched begin (B1B2(CV80,CV81), end;\ninto method label BTIF code_regex \\(BMD0, replaceall_matched begin (B1B2(MD00,MD01), end;\ninto method label BTIF code_regex \\(BMD1, replaceall_matched begin (B1B2(MD10,MD11), end;\ninto method label GBTI code_regex \\sBMD0\\) replaceall_matched begin B1B2(MD00,MD01)) end;\ninto method label GBTI code_regex \\(BMD0, replaceall_matched begin (B1B2(MD00,MD01), end;\ninto method label GBTI code_regex \\sBMD1\\) replaceall_matched begin B1B2(MD10,MD11)) end;\ninto method label GBTI code_regex \\(BMD1, replaceall_matched begin (B1B2(MD10,MD11), end;\ninto method label BTST code_regex \\(BPV0, replaceall_matched begin (B1B2(PV00,PV01), end;\ninto method label BTST code_regex \\(BPV1, replaceall_matched begin (B1B2(PV10,PV11), end;\ninto method label GBTI code_regex \\(BPV0, replaceall_matched begin (B1B2(PV00,PV01), end;\ninto method label GBTI code_regex \\(BPV1, replaceall_matched begin (B1B2(PV10,PV11), end;\ninto method label BTIF code_regex \\(BSN0, replaceall_matched begin (B1B2(SN00,SN01), end;\ninto method label BTIF code_regex \\(BSN1, replaceall_matched begin (B1B2(SN10,SN11), end;\ninto method label GBTI code_regex \\(BSN0, replaceall_matched begin (B1B2(SN00,SN01), end;\ninto method label GBTI code_regex \\(BSN1, replaceall_matched begin (B1B2(SN10,SN11), end;\ninto method label GBTI code_regex \\(BCV0, replaceall_matched begin (B1B2(BV00,BV01), end;\ninto method label GBTI code_regex \\(BCV1, replaceall_matched begin (B1B2(BV10,BV11), end;\ninto method label GBTI code_regex \\(CRG0, replaceall_matched begin (B1B2(RG00,RG01), end;\ninto method label GBTI code_regex \\(CRG1, replaceall_matched begin (B1B2(RG10,RG11), end;\ninto method label GBTI code_regex \\(CBT0, replaceall_matched begin (B1B2(BT00,BT01), end;\ninto method label GBTI code_regex \\(CBT1, replaceall_matched begin (B1B2(BT10,BT11), end;\n<\/code><\/pre>\n\n\n\n<ul><li>Tr\u01b0\u1eddng 32 bit<\/li><\/ul>\n\n\n\n<p><meta charset=\"utf-8\"> c\u00e1c b\u1ea1n l\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi c\u00e1c tr\u01b0\u1eddng 32 bit nh\u01b0ng thay v\u00ec d\u00f9ng B1B2 ta s\u1ebd d\u00f9ng B1B4<\/p>\n\n\n\n<p>B1: add \u0111o\u1ea1n code sau v\u00f2a dsdt <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label B1B4 remove_entry;\ninto definitionblock code_regex . insert\nbegin\nMethod (B1B4, 4, NotSerialized)\\n\n{\\n\n    Store(Arg3, Local0)\\n\n    Or(Arg2, ShiftLeft(Local0, 8), Local0)\\n\n    Or(Arg1, ShiftLeft(Local0, 8), Local0)\\n\n    Or(Arg0, ShiftLeft(Local0, 8), Local0)\\n\n    Return(Local0)\\n\n}\\n\nend;\n<\/code><\/pre>\n\n\n\n<p>Ta s\u1ebd \u0111\u01b0\u1ee3c nh\u01b0 h\u00ecnh <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/Ob7zlkn.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>B2: ta c\u0169ng l\u00e0m t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean nh\u01b0ng thay v\u00ec chia th\u00e0nh 2 ta s\u1ebd chia th\u00e0nh 4 ( v\u00ed d\u1ee5 nh\u01b0 BTY0 )<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/zHcejtD.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>Ta s\u1ebd add \u0111o\u1ea1n code sau v\u00e0o <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into device label EC code_regex BTY0,\\s+32 replace_matched begin TY00,8,TY01,8,TY02,8,TY03,8 end;<\/code><\/pre>\n\n\n\n<p>s\u1ebd \u0111\u01b0\u1ee3c nh\u01b0 h\u00ecnh <\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/EbehUuL.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>B3: C\u00e1c b\u1ea1n add \u0111o\u1ea1n code sau v\u00e0o \u0111\u1ec3 s\u1eeda c\u00e1c thanh ghi <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label GBTI code_regex \\(BTY0, replaceall_matched begin (B1B4(TY00,TY01,TY02,TY03), end;\n<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/yU6Cnqm.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>c\u00e1c b\u1ea1n s\u1ebd ti\u1ebfp t\u1ee5c l\u00e0m nh\u01b0 tr\u00ean cho \u0111\u1ebfn khi n\u00e0o kh\u00f4ng c\u00f2n thanh 32 bit n\u00e0o n\u1eefa<\/p>\n\n\n\n<p>B9: patch c\u00e1c tr\u01b0\u1eddng l\u1edbn h\u01a1n 32 bit<\/p>\n\n\n\n<p>\u1ede tr\u00ean ta s\u1ebd t\u00ecm th\u1ea5y c\u00e1c tr\u01b0\u1eddng l\u1edbn h\u01a1n 32 bit nh\u01b0 sau<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>   BDN0,   56,\n   BCT0,   128,\n   BDN1,   56,\n   BCT1,   128,<\/code><\/pre>\n\n\n\n<p> <\/p>\n\n\n\n<ul><li>B1: c\u00e1c b\u1ea1n ti\u1ebfn h\u00e0nh \u0111\u1ed5i t\u00ean c\u00e1c tr\u01b0\u1eddng n\u00e0y ta c\u00f3 code nh\u01b0 sau ( c\u00e1c t\u00ean sau khi \u0111\u1ed5i kh\u00f4ng \u0111\u01b0\u1ee3c tr\u00f9ng )<\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code>into device label EC code_regex (BDN0,)\\s+(56) replace_matched begin BDNX,%2,\/\/%1%2 end;\ninto device label EC code_regex (BDN1,)\\s+(56) replace_matched begin BDNY,%2,\/\/%1%2 end;\ninto device label EC code_regex (BCT0,)\\s+(128) replace_matched begin BCTX,%2,\/\/%1%2 end;\ninto device label EC code_regex (BCT1,)\\s+(128) replace_matched begin BCTY,%2,\/\/%1%2 end;\n<\/code><\/pre>\n\n\n\n<ul><li>B2: c\u00e1c b\u1ea1n s\u1ebd ti\u1ebfn h\u00e0nh x\u00e1c \u0111\u1ecbnh offset nh\u01b0 sau <\/li><\/ul>\n\n\n\n<p>\u1ede m\u1ed7i c\u00e1c tr\u01b0\u1eddng s\u1ebd c\u00f3 c\u00e1c offset nh\u01b0 sau <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>  Field (ECF2, ByteAcc, Lock, Preserve)\n   {\n            Offset (0x10),\n       BDN0,   56,     \/\/!!0x10\n            Offset (0x18),\n       BME0,   8,\n            Offset (0x20),\n       BMN0,   32,     \/\/0x20\n       BMN2,   8,     \/\/0x24\n       BMN4,   88,    \/\/0x25\n       BCT0,   128,     \/\/!! 0x30\n       BDN1,   56,     \/\/!! 0x40\n            Offset (0x48),\n       BME1,   8,\n            Offset (0x50),\n       BMN1,   32,     \/\/0x50\n       BMN3,   8,     \/\/0x54\n       BMN5,   88,     \/\/0x55\n       BCT1,   128,     \/\/!!0x60 \n<\/code><\/pre>\n\n\n\n<p>\u1edf tr\u00ean ta c\u00f3 quy t\u1eaft sau <\/p>\n\n\n\n<p>L\u1ea5y v\u00ed d\u1ee5:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code><meta charset=\"utf-8\">            Offset (0x20),\n       BMN0,   32,    \n       BMN2,   8,     \n       BMN4,   88,    \n       BCT0,   128,    \n       BDN1,   56,    <\/code><\/pre>\n\n\n\n<p>ta c\u00f3 0x20=32 ( hex to decimal )<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/V11qCj3.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>Th\u00ec BMN0 l\u00e0 0x20<\/p>\n\n\n\n<p>BMN2 l\u00e0 32+(32\/8)=32+4=36 ==&gt; 0x24<\/p>\n\n\n\n<p>BMN4 l\u00e0 32+(32\/8)+(8\/8)=32+4+1=37==&gt;0x25<\/p>\n\n\n\n<p>BCT0 l\u00e0 32+(32\/8)+(8\/8)+(88\/8)=32+4+1+11=48==&gt;0x30<\/p>\n\n\n\n<p>BDN1 l\u00e0 32+(32\/8)+(8\/8)+(88\/8)+(128\/8)=32+4+1+11+16=64==&gt;0x40<\/p>\n\n\n\n<ul><li>B3: b\u00e2y gi\u1edd khi c\u00e1c b\u1ea1n complie s\u1ebd b\u1ecb l\u1ed7i<\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/nWe1lzh.png\" alt=\"\"\/><\/figure>\n\n\n\n<p>do c\u00e1c b\u1ea1n \u0111\u00e3 \u0111\u1ed5i t\u00ean \u1edf b\u01b0\u1edbc tr\u00ean \u0111\u1ec3 fix l\u1ed7i  c\u00e1c b\u1ea1n add \u0111o\u1ea1n code sau v\u00e0o <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code># utility methods to read\/write buffers from\/to EC\ninto method label RE1B parent_label EC remove_entry;\ninto method label RECB parent_label EC remove_entry;\ninto device label EC insert\nbegin\nMethod (RE1B, 1, NotSerialized)\\n\n{\\n\n    OperationRegion(ERAM, EmbeddedControl, Arg0, 1)\\n\n    Field(ERAM, ByteAcc, NoLock, Preserve) { BYTE, 8 }\\n\n    Return(BYTE)\\n\n}\\n\nMethod (RECB, 2, Serialized)\\n\n\/\/ Arg0 - offset in bytes from zero-based EC\\n\n\/\/ Arg1 - size of buffer in bits\\n\n{\\n\n    ShiftRight(Add(Arg1,7), 3, Arg1)\\n\n    Name(TEMP, Buffer(Arg1) { })\\n\n    Add(Arg0, Arg1, Arg1)\\n\n    Store(0, Local0)\\n\n    While (LLess(Arg0, Arg1))\\n\n    {\\n\n        Store(RE1B(Arg0), Index(TEMP, Local0))\\n\n        Increment(Arg0)\\n\n        Increment(Local0)\\n\n    }\\n\n    Return(TEMP)\\n\n}\\n\nend;<\/code><\/pre>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label GBTI code_regex \\(BCT0, replaceall_matched begin (RECB(0x30,128), end;\n<\/code><\/pre>\n\n\n\n<p>ta c\u00f3 m\u1ee5c RECB (0x30,128) c\u00f3 ngh\u0129a l\u00e0 0x30 l\u00e0 offset \u0111\u00e3 x\u00e1c \u0111\u1ecbnh \u1edf tr\u00ean 128 l\u00e0 k\u00edch th\u01b0\u1edbc t\u00ednh b\u1eb1ng bit<\/p>\n\n\n\n<p>sau khi add xong ta s\u1ebd \u0111\u01b0\u1ee3c <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>   Store(RECB(0x30,128), CTN)\n<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-large\"><img src=\"https:\/\/imgur.com\/e6yzgK0.png\" alt=\"\"\/><\/figure>\n\n\n\n<ul><li>B4: \u0111\u1ed1i v\u1edbi 1 s\u1ed1 dsdt s\u1ebd hi\u1ec7n nh\u01b0 sau <\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code>   Store(Local0, BCT0)\n<\/code><\/pre>\n\n\n\n<p>th\u00ec khi n\u00e0y c\u00e1c b\u1ea1n s\u1ebd d\u00f9ng wecb thay v\u00ec recb ( g\u1ea3i th\u00edch 1 ch\u00fat recb l\u00e0 Read EC Buffer v\u00e0 wecb c\u00f3 ngh\u0129a l\u00e0 Write EC Buffer )<\/p>\n\n\n\n<p>C\u00e1c b\u1ea1n s\u1ebd add \u0111o\u1ea1n code sau v\u00e0o dsdt <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label WE1B parent_label H_EC remove_entry;\ninto method label WECB parent_label H_EC remove_entry;\ninto device label H_EC insert\nbegin\nMethod (WE1B, 2, NotSerialized)\\n\n{\\n\n    OperationRegion(ERAM, EmbeddedControl, Arg0, 1)\\n\n    Field(ERAM, ByteAcc, NoLock, Preserve) { BYTE, 8 }\\n\n    Store(Arg1, BYTE)\\n\n}\\n\nMethod (WECB, 3, Serialized)\\n\n\/\/ Arg0 - offset in bytes from zero-based EC\\n\n\/\/ Arg1 - size of buffer in bits\\n\n\/\/ Arg2 - value to write\\n\n{\\n\n    ShiftRight(Add(Arg1,7), 3, Arg1)\\n\n    Name(TEMP, Buffer(Arg1) { })\\n\n    Store(Arg2, TEMP)\\n\n    Add(Arg0, Arg1, Arg1)\\n\n    Store(0, Local0)\\n\n    While (LLess(Arg0, Arg1))\\n\n    {\\n\n        WE1B(Arg0, DerefOf(Index(TEMP, Local0)))\\n\n        Increment(Arg0)\\n\n        Increment(Local0)\\n\n    }\\n\n}\\n\nend;\n<\/code><\/pre>\n\n\n\n<ul><li>B5: add \u0111o\u1ea1n code sau v\u00f2a ( t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean )<\/li><\/ul>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label GBTI code_regex \\(BCT0, replaceall_matched begin (WECB(0x30,128,Local0), end;<\/code><\/pre>\n\n\n\n<p><strong>L\u01b0u \u00fd: c\u00f3 nhi\u1ec1u ph\u01b0\u01a1ng th\u00fac kh\u00e1c ngo\u00e0i store ra c\u00e1c b\u1ea1n ph\u1ea3i bi\u1ebft t\u00f9y c\u01a1 \u1ee9ng bi\u1ebfn <\/strong><\/p>\n\n\n\n<p><strong>Nh\u01b0 \u1edf \u0111\u00e2y ta c\u00f3 <\/strong><\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>        Name (SMBF, Zero)\n        OperationRegion (SMBX, EmbeddedControl, 0x18, 0x28)\n        Field (SMBX, ByteAcc, NoLock, Preserve)\n        {\n            PRTC,   8, \n            SSTS,   5, \n                ,   1, \n            ALFG,   1, \n            CDFG,   1, \n            ADDR,   8, \n            CMDB,   8, \n            BDAT,   256, \n            BCNT,   8, \n                ,   1, \n            ALAD,   7, \n            ALD0,   8, \n            ALD1,   8\n        }\n\n        OperationRegion (SMB2, EmbeddedControl, 0x40, 0x28)\n        Field (SMB2, ByteAcc, NoLock, Preserve)\n        {\n            PRT2,   8, \n            SST2,   5, \n                ,   1, \n            ALF2,   1, \n            CDF2,   1, \n            ADD2,   8, \n            CMD2,   8, \n            BDA2,   256, \n            BCN2,   8, \n                ,   1, \n            ALA2,   7, \n            ALR0,   8, \n            ALR1,   8\n        }\n<\/code><\/pre>\n\n\n\n<p><strong>th\u00ec ta c\u00f3 th\u1ec3 th\u1ea5y offset \u0111ang b\u1ecb \u1ea9n \u0111i nh\u01b0ng nh\u00ecn v\u00e0o \u0111\u00e2y ta nh\u1eadn th\u1ea5y offset 0x28 l\u00e0 ch\u1ec9 v\u1ecb tr\u00ed c\u1ee7a 2 c\u00e1i SMB2 v\u00e0 SMBX n\u00ean c\u00e1i \u0111\u1ea7u ti\u00ean s\u1ebd c\u00f3 offset l\u00e0 0x18 c\u00e1i th\u1ee9 2 s\u1ebd c\u00f3 offset l\u00e0 0x40 <\/strong><\/p>\n\n\n\n<p><strong>B\u00e2y gi\u1edd ta th\u1eed x\u00e1c \u0111\u1ecbnh offset c\u1ee7a BDAT l\u00e0 <\/strong><\/p>\n\n\n\n<p><strong>24+(8\/8)+(5\/8+1\/8+1\/8+1\/8)+(8\/8)+(8\/8)=24+1+1+1+1=28==&gt;0x1c<\/strong><\/p>\n\n\n\n<p>B10: fix Logic bug with charging\/discharging status<\/p>\n\n\n\n<p>1 s\u1ed1 laptop asus c\u00f3 th\u1ec3 g\u1eb7p t\u00ecnh tr\u1ea1ng khi s\u1ea1c \u0111\u1ea7y nh\u01b0ng h\u1ec7 th\u1ed1ng v\u1eabn b\u00e1o ch\u01b0a \u0111\u1ea7y ho\u1eb7c khi h\u1ebft pin nh\u01b0ng h\u1ec7 th\u1ed1ng v\u1eabn b\u00e1o ch\u01b0a h\u1ebft pin d\u1eabn \u0111\u1ebfn c\u00e1c l\u1ed7i nh\u01b0 s\u1eadp ngu\u1ed3n b\u1ea5t ch\u1ee3t ( l\u1ed7i n\u00e3y v\u1eabn c\u00f3 th\u1ec3 x\u1ea3y ra \u1edf 1 s\u00f3 m\u00e1y model kh\u00e1c ) c\u00e1ch fix l\u00e0 c\u00e1c b\u1ea1n add \u0111o\u1ea1n sau v\u00e0o <\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>into method label FBST code_regex If\\s\\(CHGS\\s\\(Zero\\)\\)&#91;\\s]+\\{&#91;\\s]+Store\\s\\(0x02,\\sLocal0\\)&#91;\\s]+\\}&#91;\\s]+Else&#91;\\s]+\\{&#91;\\s]+Store\\s\\(One,\\sLocal0\\)&#91;\\s]+\\} replaceall_matched begin\nIf (CHGS (Zero))\\n\n{\\n\n     Store (0x02, Local0)\\n\n}\\n\nElse\\n\n{\\n\n     Store (Zero, Local0)\\n\n}\nend;<\/code><\/pre>\n\n\n\n<p>Nh\u01b0 v\u1eady l\u00e0 xong r\u1ed3i c\u00e1c b\u1ea1n ti\u1ebfn h\u00e0nh bi\u00ean d\u1ecbch ng\u01b0\u1ee3c l\u1ea1i theo <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvii-patch-dsdt-phan-1\/\">links<\/a> v\u00e0 d\u00f9ng th\u00f4i <\/p>\n\n\n\n<p><strong>L\u01b0u \u00fd 1: khi update bios c\u00e1c patch s\u1ebd b\u1ecb m\u1ea5t c\u00e1c b\u1ea1n s\u1ebd ti\u1ebfn h\u00e0nh add l\u1ea1i ho\u1eb7c c\u00e1c b\u1ea1n ti\u1ebfn h\u00e0nh hotpatch b\u1eb1ng c\u00e1ch tr\u00edch dsdt theo h\u01b0\u1edbng d\u1eabn <a href=\"https:\/\/heavietnam.ga\/2021\/09\/29\/xxvii-patch-dsdt-phan-3\/\">t\u1ea1i \u0111\u00e2y<\/a><\/strong> <\/p>\n\n\n\n<p><strong>L\u01b0u \u00fd 2: c\u00e1c source tham kh\u1ea3o <a href=\"https:\/\/www.tonymacx86.com\/threads\/guide-how-to-patch-dsdt-for-working-battery-status.116102\/\">[Guide] How to patch DSDT for working battery status | tonymacx86.com<\/a> | <a href=\"https:\/\/www.olarila.com\/topic\/5673-guide-laptop-battery-indicator-the-dsdt-patching-horror\/\">[Guide] Laptop Battery Indicator &#8211; The DSDT Patching Horror &#8211; Page 14 &#8211; Guides and Tutorials &#8211; Olarila<\/a> ( thank you )<\/strong><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Danh m\u1ee5c P1: t\u00ecm hi\u1ec3u thu\u1eadt ng\u1eef&nbsp;P2 : ti\u1ebfn h\u00e0nh C\u00e1ch 1: D\u00f9ng kext ECENABLERC\u00e1ch 2: D\u00f9ng c\u00e1c patch s\u1eb5n c\u1ee7a rehabman C\u00e1ch 3: Ti\u1ebfn h\u00e0nh th\u1ee7 c\u00f4ng P1: t\u00ecm hi\u1ec3u thu\u1eadt ng\u1eef&nbsp; Tr\u01b0\u1edbc ti\u00ean ta ph\u1ea3i hi\u1ec3u nguy\u00ean t\u00e1c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a c\u00e1ch l\u00e0 sau \u0111\u00e2y V\u00ec \u1edf c\u00e1c b\u1ea3n AppleACPIPlatform m\u1edbi n\u00f3 ko [&#8230;]\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[48],"tags":[],"_links":{"self":[{"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/posts\/79"}],"collection":[{"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/comments?post=79"}],"version-history":[{"count":7,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/posts\/79\/revisions"}],"predecessor-version":[{"id":866,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/posts\/79\/revisions\/866"}],"wp:attachment":[{"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/media?parent=79"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/categories?post=79"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/heavietnam.ga\/wp-json\/wp\/v2\/tags?post=79"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}